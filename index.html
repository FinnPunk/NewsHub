<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>NewsHub - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π —Å AI</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/dock.css">
    <meta name="description" content="–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –≤–∞–∫–∞–Ω—Å–∏–π —Å AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–µ–π –¥–ª—è 100 –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –†–æ—Å—Å–∏–∏">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4A90E2">
</head>
<body>
    <div class="app" id="mainApp">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="site-title">NewsHub</h1>
                    <nav class="breadcrumb" id="breadcrumb">
                        <span class="breadcrumb-item active">–õ–µ–Ω—Ç–∞</span>
                        <span class="breadcrumb-item">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                        <span class="breadcrumb-item">–ü—Ä–æ—Ñ–∏–ª—å</span>
                    </nav>
                </div>
                <div class="header-actions">
                    <div class="app-version" id="appVersion">v2.2.1</div>
                    <button class="btn btn--icon" id="settingsToggle" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                        </svg>
                    </button>
                    <button class="btn btn--icon" id="searchToggle" title="–ü–æ–∏—Å–∫">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Expandable Search -->
            <div class="search-bar hidden" id="searchBar">
                <div class="search-input-wrapper">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                    </svg>
                    <input type="text" id="searchInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π –∏ –Ω–æ–≤–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫)" autocomplete="off">
                    <button class="search-clear hidden" id="searchClear">√ó</button>
                </div>
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
        </header>

        <!-- Settings Dropdown (–≤–Ω–µ header –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ z-index) -->
        <div class="settings-dropdown" id="settingsDropdown">
            <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-title">–ò—Å—Ç–æ—á–Ω–∏–∫–∏</div>
                    <div class="setting-desc">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RSS –∏ VK –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏</div>
                </div>
                <button class="btn btn--secondary btn--sm" id="manageSourcesBtn">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å</button>
            </div>
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-title">OpenAI API</div>
                    <div class="setting-desc">–ö–ª—é—á –¥–ª—è AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏</div>
                </div>
                <button class="btn btn--secondary btn--sm" id="setupOpenAIBtn">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å</button>
            </div>
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-title">–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</div>
                    <div class="setting-desc">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–µ–Ω—Ç—ã</div>
                </div>
                <select class="setting-select" id="updateFrequency">
                    <option value="900000">15 –º–∏–Ω—É—Ç</option>
                    <option value="3600000" selected>1 —á–∞—Å</option>
                    <option value="7200000">2 —á–∞—Å–∞</option>
                </select>
            </div>
            <div class="setting-item" style="border-top: 1px solid var(--border-light); padding-top: 1rem; margin-top: 1rem;">
                <div class="setting-info">
                    <div class="setting-title" style="color: var(--error-color);">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</div>
                    <div class="setting-desc">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã –∏ –∫—ç—à</div>
                </div>
                <button class="btn btn--danger btn--sm" id="clearAllDataBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>

        <!-- Sources Management Modal (RSS + VK) -->
        <div class="modal hidden" id="rssSourcesModal">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2>üì° –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏</h2>
                    <button class="modal-close" data-modal="rssSourcesModal">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- –í–∫–ª–∞–¥–∫–∏ -->
                    <div class="tabs" style="margin-bottom: 1.5rem;">
                        <button class="tab-btn active" data-tab="rss">üì∞ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–∏</button>
                        <button class="tab-btn" data-tab="vk">üì± VK –≥—Ä—É–ø–ø—ã</button>
                    </div>
                    
                    <!-- RSS Tab -->
                    <div class="tab-content active" id="rss-tab">
                        <p class="modal-desc">–î–æ–±–∞–≤–ª—è–π—Ç–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –Ω–æ–≤–æ—Å—Ç–µ–π</p>
                    
                    <!-- Add New Source -->
                    <div class="rss-add-section">
                        <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫</h3>
                        <div class="rss-add-form">
                            <input type="text" id="rssSourceName" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞" style="margin-bottom: 0.5rem;">
                            <input type="url" id="rssSourceUrl" class="form-control" placeholder="URL RSS –ª–µ–Ω—Ç—ã" style="margin-bottom: 0.5rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <select id="rssSourceCategory" class="form-control">
                                    <option value="tech">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                                    <option value="news">–ù–æ–≤–æ—Å—Ç–∏</option>
                                    <option value="business">–ë–∏–∑–Ω–µ—Å</option>
                                    <option value="design">–î–∏–∑–∞–π–Ω</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                                <button class="btn btn--primary" id="addRssSourceBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <!-- Current Sources List -->
                    <div class="rss-sources-list">
                        <h3>üìã –ê–∫—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h3>
                        <div id="rssSourcesList" class="sources-grid">
                            <!-- Sources will be loaded here -->
                        </div>
                    </div>
                    </div>
                    
                    <!-- VK Tab -->
                    <div class="tab-content" id="vk-tab">
                        <p class="modal-desc">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ VK –≥—Ä—É–ø–ø–∞–º–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π</p>
                        
                        <!-- VK Groups List -->
                        <div class="vk-groups-list">
                            <h3>üì± VK –ì—Ä—É–ø–ø—ã</h3>
                            <div id="vkGroupsList" class="sources-grid">
                                <!-- VK groups will be loaded here -->
                            </div>
                        </div>
                        
                        <!-- Add Custom VK Group -->
                        <div class="vk-add-section" style="margin-top: 1.5rem;">
                            <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å VK –≥—Ä—É–ø–ø—É</h3>
                            <div class="rss-add-form">
                                <input type="text" id="vkGroupName" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã" style="margin-bottom: 0.5rem;">
                                <input type="text" id="vkGroupId" class="form-control" placeholder="ID –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: habr)" style="margin-bottom: 0.5rem;">
                                <div style="display: flex; gap: 0.5rem;">
                                    <select id="vkGroupCategory" class="form-control">
                                        <option value="tech">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                                        <option value="business">–ë–∏–∑–Ω–µ—Å</option>
                                        <option value="design">–î–∏–∑–∞–π–Ω</option>
                                        <option value="education">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                                        <option value="general">–û–±—â–µ–µ</option>
                                    </select>
                                    <button id="addVkGroupBtn" class="btn btn--primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OpenAI API Management Modal -->
        <div class="modal hidden" id="openaiModal">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h2>ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenAI API</h2>
                    <button class="modal-close" data-modal="openaiModal">√ó</button>
                </div>
                <div class="modal-body">
                    <p class="modal-desc">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ OpenAI API –∫–ª—é—á –¥–ª—è AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–∞—Ç–∫–∏—Ö –æ–ø–∏—Å–∞–Ω–∏–π</p>
                    
                    <!-- API Key Status -->
                    <div class="api-status-section">
                        <div class="status-card" id="apiStatusCard">
                            <div class="status-icon" id="apiStatusIcon">‚ùå</div>
                            <div class="status-info">
                                <div class="status-title" id="apiStatusTitle">API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>
                                <div class="status-desc" id="apiStatusDesc">–î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI —Ñ—É–Ω–∫—Ü–∏–π</div>
                            </div>
                        </div>
                    </div>

                    <!-- API Key Input -->
                    <div class="api-input-section">
                        <h3>üîë API –ö–ª—é—á</h3>
                        <div class="api-input-form">
                            <input type="password" id="openaiApiKeyInput" class="form-control" placeholder="sk-proj-xxxxxxxxxxxxxxxx" style="margin-bottom: 0.5rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn--primary" id="saveApiKeyBtn" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button class="btn btn--secondary" id="testApiKeyBtn" style="flex: 1;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                                <button class="btn btn--ghost" id="removeApiKeyBtn">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <!-- Info Section -->
                    <div class="api-info-section">
                        <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <ul class="info-list">
                            <li>AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å GPT-3.5-turbo</li>
                            <li>–ö–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</li>
                            <li>–ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –Ω–∞ <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com</a></li>
                            <li>–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ~$0.002 –∑–∞ –æ–¥–Ω—É —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Feed Page -->
            <div class="page active" id="feedPage">
                <!-- Quick Filters -->
                <div class="quick-filters" id="quickFilters">
                    <div class="filter-chips">
                        <button class="filter-chip active" data-filter="all">–í—Å–µ</button>
                        <button class="filter-chip" data-filter="news">–ù–æ–≤–æ—Å—Ç–∏</button>
                        <button class="filter-chip" data-filter="vk-news">–ù–æ–≤–æ—Å—Ç–∏ –∏–∑ –í–ö</button>
                        <button class="filter-chip" data-filter="jobs">–í–∞–∫–∞–Ω—Å–∏–∏</button>
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--icon" id="refreshBtn" title="–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                        </button>
                        <button class="btn btn--icon" id="filtersToggle" title="–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
                            </svg>
                            <span class="filter-indicator hidden" id="filterIndicator"></span>
                        </button>
                    </div>
                </div>

                <!-- Content Feed -->
                <div class="feed-container" id="feedContainer">
                    <!-- Content cards will be loaded here -->
                </div>

                <!-- Loading Spinner -->
                <div class="loading-spinner" id="loadingSpinner">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –≤–∞–∫–∞–Ω—Å–∏–π...</p>
                </div>

                <!-- Skeleton Loading -->
                <div class="skeleton-container hidden" id="skeletonContainer">
                    <!-- Skeleton cards for infinite scroll -->
                </div>

                <!-- End of Feed -->
                <div class="end-of-feed hidden" id="endOfFeed">
                    <div class="end-icon">üéâ</div>
                    <h3>–í—ã –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –≤—Å—ë!</h3>
                    <p>–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
                    <button class="btn btn--primary" onclick="location.reload()">–û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>
            </div>

            <!-- Favorites Page -->
            <div class="page" id="favoritesPage">
                <div class="page-header">
                    <h2>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
                    <p class="page-subtitle">–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
                </div>
                <div class="favorites-feed" id="favoritesFeed">
                    <!-- Saved items will be loaded here -->
                </div>
                <div class="empty-state hidden" id="emptyFavorites">
                    <div class="empty-icon">‚≠ê</div>
                    <h3>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                    <p>–ù–∞—á–Ω–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
                </div>
            </div>

            <!-- Profile Page -->
            <div class="page" id="profilePage">
                <div class="profile-container">
                    <!-- Profile Header -->
                    <div class="profile-header">
                        <div class="profile-avatar-container">
                            <img class="profile-avatar" id="profileAvatar" src="https://i.pravatar.cc/150?img=12" alt="–ü—Ä–æ—Ñ–∏–ª—å">
                            <button class="avatar-edit-btn" id="editAvatarBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="profile-info">
                            <h2 class="profile-name" id="profileName">–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                            <p class="profile-profession" id="profileProfession">Frontend Developer</p>
                            <p class="profile-location" id="profileLocation">–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è</p>
                        </div>
                        <button class="btn btn--primary btn--sm" id="editProfileBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                            </svg>
                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>

                    <!-- Statistics -->
                    <div class="stats-section">
                        <h3 class="section-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number" id="articlesReadStat">0</div>
                                <div class="stat-label">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="articlesSavedStat">0</div>
                                <div class="stat-label">–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="sourcesCountStat">10</div>
                                <div class="stat-label">–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="readingTimeStat">0—á</div>
                                <div class="stat-label">–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è</div>
                            </div>
                        </div>
                    </div>

                    <!-- Skills Section -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h3 class="section-title">üíº –ù–∞–≤—ã–∫–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h3>
                            <button class="btn btn--ghost btn--sm" id="editSkillsBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                        <div class="skills-list" id="skillsList">
                            <!-- Skills will be loaded here -->
                        </div>
                    </div>

                    <!-- Portfolio Section -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h3 class="section-title">üìÇ –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</h3>
                            <button class="btn btn--ghost btn--sm" id="editPortfolioBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                        <div class="portfolio-grid" id="portfolioGrid">
                            <!-- Portfolio items will be loaded here -->
                        </div>
                    </div>

                    <!-- Statistics Section -->
                    <div class="profile-section">
                        <h3 class="section-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number">0</div>
                                <div class="stat-label">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å—Ç–∞—Ç–µ–π</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">0</div>
                                <div class="stat-label">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">0</div>
                                <div class="stat-label">–î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- NewsHub Dock - React Bits Style -->
        <div class="dock-container" id="newsHubDock">
            <!-- Dock will be dynamically created by newsHubDock.js -->
        </div>
    </div>

    <!-- Filters Modal -->
    <div class="modal hidden" id="filtersModal">
        <div class="modal-backdrop" onclick="document.getElementById('filtersModal').classList.add('hidden')"></div>
        <div class="modal-content filters-modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon">üéØ</div>
                    <div>
                        <h2>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã</h2>
                        <p class="modal-subtitle">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ª–µ–Ω—Ç—É –Ω–æ–≤–æ—Å—Ç–µ–π</p>
                    </div>
                </div>
                <button class="modal-close" onclick="document.getElementById('filtersModal').classList.add('hidden')">√ó</button>
            </div>
            <div class="modal-body filters-modal-body">
                <!-- Date Range Filter -->
                <div class="filter-section">
                    <div class="filter-section-header">
                        <div class="filter-icon">üìÖ</div>
                        <div>
                            <h3>–ü–µ—Ä–∏–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h3>
                            <p class="filter-desc">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω</p>
                        </div>
                    </div>
                    <div class="date-filter-pills">
                        <label class="pill-option">
                            <input type="radio" name="dateFilter" value="all" checked>
                            <span class="pill-label">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                                </svg>
                                –í—Å–µ –≤—Ä–µ–º—è
                            </span>
                        </label>
                        <label class="pill-option">
                            <input type="radio" name="dateFilter" value="today">
                            <span class="pill-label">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                                </svg>
                                –°–µ–≥–æ–¥–Ω—è
                            </span>
                        </label>
                        <label class="pill-option">
                            <input type="radio" name="dateFilter" value="week">
                            <span class="pill-label">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"/>
                                </svg>
                                –ù–µ–¥–µ–ª—è
                            </span>
                        </label>
                        <label class="pill-option">
                            <input type="radio" name="dateFilter" value="month">
                            <span class="pill-label">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10z"/>
                                </svg>
                                –ú–µ—Å—è—Ü
                            </span>
                        </label>
                    </div>
                </div>


                <!-- Job Filters (HH.ru) -->
                <div class="filter-section">
                    <div class="filter-section-header">
                        <div class="filter-icon">üíº</div>
                        <div>
                            <h3>–§–∏–ª—å—Ç—Ä—ã –≤–∞–∫–∞–Ω—Å–∏–π (HH.ru)</h3>
                            <p class="filter-desc">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π</p>
                        </div>
                    </div>
                    
                    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å–µ—Ç–∫–∞ 2 –∫–æ–ª–æ–Ω–∫–∏ -->
                    <div class="job-filters-grid">
                        
                        <div class="job-filter-group" style="grid-column: span 2;">
                            <label for="jobType">üíº –¢–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏</label>
                            <select id="jobType" class="form-control">
                                <option value="">–õ—é–±–∞—è</option>
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CONFIG.jobTypes -->
                            </select>
                            <span class="input-hint">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ VK –≥—Ä—É–ø–ø—ã</span>
                        </div>
                        
                        <div class="job-filter-group">
                            <label for="jobCity">üåç –ì–æ—Ä–æ–¥</label>
                            <select id="jobCity" class="form-control">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CONFIG.cities -->
                            </select>
                        </div>

                        <div class="job-filter-group">
                            <label for="jobExperience">üíº –û–ø—ã—Ç</label>
                            <select id="jobExperience" class="form-control">
                                <option value="">–õ—é–±–æ–π</option>
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CONFIG.experienceLevels -->
                            </select>
                        </div>

                        <div class="job-filter-group">
                            <label for="jobSchedule">üìÖ –ì—Ä–∞—Ñ–∏–∫</label>
                            <select id="jobSchedule" class="form-control">
                                <option value="">–õ—é–±–æ–π</option>
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CONFIG.schedules -->
                            </select>
                        </div>

                        <div class="job-filter-group">
                            <label for="jobEmployment">üè¢ –ó–∞–Ω—è—Ç–æ—Å—Ç—å</label>
                            <select id="jobEmployment" class="form-control">
                                <option value="">–õ—é–±–∞—è</option>
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CONFIG.employmentTypes -->
                            </select>
                        </div>

                        <div class="job-filter-group" style="grid-column: span 2;">
                            <label for="jobSalary">üí∞ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞</label>
                            <input type="number" id="jobSalary" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 100 000 ‚ÇΩ" min="0" step="10000">
                        </div>
                    </div>

                    <!-- –ß–µ–∫–±–æ–∫—Å –æ—Ç–¥–µ–ª—å–Ω–æ -->
                    <label class="toggle-option" style="margin-top: 1rem;">
                        <input type="checkbox" id="jobOnlyWithSalary">
                        <span class="toggle-content">
                            <span class="toggle-title">‚úì –¢–æ–ª—å–∫–æ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∑–∞—Ä–ø–ª–∞—Ç—ã</span>
                        </span>
                        <div class="toggle-switch"></div>
                    </label>
                </div>
            </div>
            <div class="modal-footer filters-modal-footer">
                <button class="btn btn--ghost" id="resetFiltersBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                    </svg>
                    –°–±—Ä–æ—Å–∏—Ç—å
                </button>
                <button class="btn btn--primary" id="applyFiltersBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                </button>
            </div>
        </div>
    </div>

    <!-- Article Modal -->
    <div class="modal hidden" id="articleModal">
        <div class="modal-backdrop" onclick="closeArticleModal()"></div>
        <div class="modal-content article-modal-content">
            <div class="modal-header">
                <h3 id="articleModalTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏</h3>
                <button class="modal-close" onclick="closeArticleModal()">√ó</button>
            </div>
            <div class="modal-body article-modal-body">
                <div class="article-meta">
                    <div class="source-info">
                        <span class="source-icon" id="articleModalIcon">üì∞</span>
                        <span class="source-name" id="articleModalSource">–ò—Å—Ç–æ—á–Ω–∏–∫</span>
                        <span class="publish-time" id="articleModalTime">–≤—Ä–µ–º—è</span>
                    </div>
                    <div class="article-actions">
                        <button class="action-btn like-btn" id="articleModalLike">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                            <span class="like-count">0</span>
                        </button>
                        <button class="action-btn save-btn" id="articleModalSave">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="article-content" id="articleModalContent">
                    <p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç–∞—Ç—å–∏ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–¥–µ—Å—å...</p>
                </div>
                <div class="comments-section">
                    <h4>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h4>
                    <div class="comment-form">
                        <textarea placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." id="commentText"></textarea>
                        <button class="btn btn--primary" onclick="addComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                    <div class="comments-list" id="commentsList">
                        <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#" target="_blank" class="btn btn--primary" id="articleModalLink">
                    –ß–∏—Ç–∞—Ç—å –Ω–∞ —Å–∞–π—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
                </a>
                <button class="btn btn--secondary" onclick="window.summarizeArticle()" id="summarizeArticleBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                    –°—É–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- Job Details Modal -->
    <div class="modal hidden" id="jobModal">
        <div class="modal-backdrop" onclick="window.closeJobModal()"></div>
        <div class="modal-content job-modal-content">
            <div class="modal-header">
                <div>
                    <h3 id="jobModalTitle">–í–∞–∫–∞–Ω—Å–∏—è</h3>
                    <p class="job-modal-company" id="jobModalCompany">–ö–æ–º–ø–∞–Ω–∏—è</p>
                </div>
                <button class="modal-close" onclick="window.closeJobModal()">√ó</button>
            </div>
            <div class="modal-body job-modal-body">
                <div class="job-modal-header">
                    <img id="jobModalLogo" src="" alt="" class="job-modal-logo" style="display: none;">
                    <div class="job-modal-info">
                        <div class="job-modal-salary" id="jobModalSalary">üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞</div>
                        <div class="job-modal-meta">
                            <span id="jobModalLocation">üìç –õ–æ–∫–∞—Ü–∏—è</span>
                            <span id="jobModalExperience">üìÖ –û–ø—ã—Ç</span>
                            <span id="jobModalSchedule">‚è∞ –ì—Ä–∞—Ñ–∏–∫</span>
                        </div>
                    </div>
                </div>
                
                <div class="job-modal-section">
                    <h4>üìã –û–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏</h4>
                    <div id="jobModalDescription"></div>
                </div>
                
                <div class="job-modal-section">
                    <h4>‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</h4>
                    <div id="jobModalRequirements"></div>
                </div>
                
                <div class="job-modal-section">
                    <h4>üéØ –û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏</h4>
                    <div id="jobModalResponsibility"></div>
                </div>
                
                <div id="jobAIAssessment" class="job-ai-assessment" style="display: none;">
                    <h4>ü§ñ AI –û—Ü–µ–Ω–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–∏</h4>
                    <div id="jobAIAssessmentContent"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" onclick="window.assessJob()" id="assessJobBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    –û—Ü–µ–Ω–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é (AI)
                </button>
                <a href="#" target="_blank" class="btn btn--primary" id="jobModalLink">
                    –û—Ç–∫—Ä—ã—Ç—å –Ω–∞ HH.ru
                </a>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal hidden" id="editProfileModal">
        <div class="modal-backdrop" onclick="window.closeEditProfileModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div>
                    <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
                    <p style="color: var(--text-secondary); font-size: 0.875rem; margin: 0.5rem 0 0 0;">
                        –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π
                    </p>
                </div>
                <button class="modal-close" onclick="window.closeEditProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="profileNameInput">üë§ –ò–º—è</label>
                    <input type="text" id="profileNameInput" class="form-control" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
                </div>
                
                <div class="form-group">
                    <label for="profileProfessionInput">üíº –ü—Ä–æ—Ñ–µ—Å—Å–∏—è</label>
                    <input type="text" id="profileProfessionInput" class="form-control" placeholder="Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫">
                </div>
                
                <div class="form-group">
                    <label for="profileLocationInput">üìç –õ–æ–∫–∞—Ü–∏—è</label>
                    <input type="text" id="profileLocationInput" class="form-control" placeholder="–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è">
                </div>
                
                <div class="form-group">
                    <label for="profileExperienceInput">üìÖ –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</label>
                    <select id="profileExperienceInput" class="form-control">
                        <option value="">–ù–µ —É–∫–∞–∑–∞–Ω</option>
                        <option value="–ù–µ—Ç –æ–ø—ã—Ç–∞">–ù–µ—Ç –æ–ø—ã—Ç–∞</option>
                        <option value="–ú–µ–Ω–µ–µ 1 –≥–æ–¥–∞">–ú–µ–Ω–µ–µ 1 –≥–æ–¥–∞</option>
                        <option value="1-3 –≥–æ–¥–∞">1-3 –≥–æ–¥–∞</option>
                        <option value="3-6 –ª–µ—Ç">3-6 –ª–µ—Ç</option>
                        <option value="–ë–æ–ª–µ–µ 6 –ª–µ—Ç">–ë–æ–ª–µ–µ 6 –ª–µ—Ç</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="profileSkillsInput">üéØ –ù–∞–≤—ã–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <textarea id="profileSkillsInput" class="form-control" rows="3" placeholder="JavaScript, React, TypeScript, HTML, CSS"></textarea>
                    <small style="color: var(--text-secondary); font-size: 0.75rem;">
                        –£–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ –Ω–∞–≤—ã–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –¥–ª—è –ª—É—á—à–µ–π –æ—Ü–µ–Ω–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="profileBioInput">üìù –û —Å–µ–±–µ</label>
                    <textarea id="profileBioInput" class="form-control" rows="4" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ, –æ–ø—ã—Ç–µ –∏ —Ü–µ–ª—è—Ö"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--ghost" onclick="window.closeEditProfileModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn--primary" onclick="window.saveProfile()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                    </svg>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="js/filterSystem.js?v=1.3.0"></script>
    <script src="js/rssAggregator.js?v=1.3.0"></script>
    <script src="js/newsCardRenderer.js?v=1.3.0"></script>
    <script src="js/newsHubDock.js?v=1.3.0"></script>
    <script src="js/pixelBlastInit.js?v=1.1.0"></script>
    
    <!-- VK ID SDK –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <script src="https://unpkg.com/@vkid/sdk@<3.0.0/dist-sdk/umd/index.js"></script>
    
    <!-- Theme initialization - must be first -->
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ DOM –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            const theme = savedTheme || systemTheme;
            
            document.documentElement.setAttribute('data-theme', theme);
            document.body.className = (document.body.className || '') + ` theme-${theme}`;
        })();
    </script>
    
    
    <!-- Initialization script -->
    <script>
        // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫—ç—à–µ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        // if ('serviceWorker' in navigator && 'caches' in window) {
        //     caches.keys().then(function(cacheNames) {
        //         return Promise.all(
        //             cacheNames.map(function(cacheName) {
        //                 if (cacheName.startsWith('newshub-old')) {
        //                     return caches.delete(cacheName);
        //                 }
        //             })
        //         );
        //     });
        // }
        
        // –û—á–∏—Å—Ç–∫–∞ localStorage –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
        // localStorage.clear();
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∞–∫–∞–Ω—Å–∏–π - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞—Ä–∞–Ω–µ–µ
        window.jobsApiReady = false;
        
        // –ü—Ä–æ—Å—Ç–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–∫-–±–∞—Ä
            const dockBar = document.querySelector('.dock-bar');
            const dockButtons = document.querySelectorAll('.dock-btn');
            
            if (dockBar) {
                // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –¥–æ–∫-–±–∞—Ä visible
                dockBar.style.display = 'flex';
                dockBar.style.visibility = 'visible';
                dockBar.style.opacity = '1';
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏
                dockButtons.forEach((btn, index) => {
                    const icon = btn.querySelector('.dock-icon');
                    const label = btn.querySelector('.dock-label');
                    const svg = btn.querySelector('svg');
                    
                    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∫–Ω–æ–ø–∫–∏
                    btn.style.display = 'inline-flex';
                    btn.style.visibility = 'visible';
                    btn.style.opacity = '1';
                    if (icon) {
                        icon.style.display = 'flex';
                        icon.style.visibility = 'visible';
                        icon.style.opacity = '1';
                    }
                    if (label) {
                        label.style.display = 'block';
                        label.style.visibility = 'visible';
                        label.style.opacity = '1';
                    }
                    if (svg) {
                        svg.style.display = 'block';
                        svg.style.visibility = 'visible';
                        svg.style.opacity = '1';
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
                    btn.addEventListener('click', function() {
                        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                        dockButtons.forEach(b => b.classList.remove('active'));
                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π
                        this.classList.add('active');
                    });
                });
            }
            
            const isFirstVisit = !localStorage.getItem('newshub_setup_completed');
            const welcomeModal = document.getElementById('welcomeModal');
            const mainApp = document.getElementById('mainApp');
            
            if (isFirstVisit && welcomeModal && mainApp) {
                welcomeModal.classList.remove('hidden');
                welcomeModal.style.display = 'flex';
                mainApp.classList.add('hidden');
                
                // –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏
                const popularJobs = [
                    'Frontend Developer', 'Backend Developer', 'Full-stack Developer',
                    'Product Manager', 'UX/UI Designer', 'Data Scientist',
                    'DevOps Engineer', 'QA Engineer', 'Marketing Manager',
                    'Sales Manager', 'Project Manager', 'Business Analyst',
                    'Mobile Developer', 'Python Developer', 'Java Developer',
                    'React Developer', 'Node.js Developer', 'PHP Developer',
                    'Data Analyst', 'Scrum Master'
                ];
                
                const container = document.getElementById('popularJobsGrid');
                if (container) {
                    const buttonsHTML = popularJobs.map(job => 
                        `<button class="job-btn" onclick="selectProfession('${job}')">${job}</button>`
                    ).join('');
                    container.innerHTML = buttonsHTML;
                }
            } else if (mainApp) {
                mainApp.classList.remove('hidden');
                if (welcomeModal) {
                    welcomeModal.classList.add('hidden');
                    welcomeModal.style.display = 'none';
                }
            }
        });
        
        let selectedProfessions = [];
        
        function selectProfession(profession) {
            if (selectedProfessions.includes(profession)) return;
            
            selectedProfessions = [profession]; // –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –ø—Ä–æ—Ñ–µ—Å—Å–∏—é
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.querySelectorAll('.job-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.textContent === profession);
            });
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            const setupBtn = document.getElementById('setupComplete');
            if (setupBtn) {
                setupBtn.disabled = false;
                setupBtn.onclick = completeSetup;
            }
        }
        
        function completeSetup() {
            if (selectedProfessions.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è');
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            localStorage.setItem('newshub_setup_completed', 'true');
            localStorage.setItem('selected_profession', selectedProfessions[0]);
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≥–ª–∞–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
            const welcomeModal = document.getElementById('welcomeModal');
            const mainApp = document.getElementById('mainApp');
            
            if (welcomeModal && mainApp) {
                welcomeModal.classList.add('hidden');
                welcomeModal.style.display = 'none';
                mainApp.classList.remove('hidden');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (window.filterSystem) {
                window.filterSystem.showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ NewsHub!', 'success');
            }
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OpenAI API –∫–ª—é—á–∞
        function testOpenAIKey() {
            const keyInput = document.getElementById('openaiKey');
            const testBtn = document.getElementById('testApiKey');
            
            if (!keyInput || !testBtn) return;
            
            const apiKey = keyInput.value.trim();
            
            if (!apiKey) {
                alert('–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                return;
            }
            
            if (!apiKey.startsWith('sk-')) {
                alert('API –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å "sk-"');
                return;
            }
            
            testBtn.textContent = '–ü—Ä–æ–≤–µ—Ä—è–µ–º...';
            testBtn.disabled = true;
            
            // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ API –∫–ª—é—á–∞
            setTimeout(() => {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á
                localStorage.setItem('openai_api_key', apiKey);
                
                testBtn.textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                testBtn.style.background = 'var(--success)';
                testBtn.style.color = 'white';
                
                if (window.filterSystem) {
                    window.filterSystem.showToast('OpenAI API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
                }
                
                setTimeout(() => {
                    testBtn.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
                    testBtn.disabled = false;
                    testBtn.style.background = '';
                    testBtn.style.color = '';
                }, 2000);
            }, 1500);
        }
        
        // –ü–æ–∏—Å–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º –æ–∫–Ω–µ
        function setupJobSearch() {
            const jobSearchInput = document.getElementById('jobSearchInput');
            const jobSearchResults = document.getElementById('jobSearchResults');
            const jobSearchClear = document.getElementById('jobSearchClear');
            
            if (!jobSearchInput || !jobSearchResults) return;
            
            const allProfessions = [
                'Frontend Developer', 'Backend Developer', 'Full-stack Developer',
                'Product Manager', 'UX/UI Designer', 'Data Scientist',
                'DevOps Engineer', 'QA Engineer', 'Marketing Manager',
                'Sales Manager', 'Project Manager', 'Business Analyst',
                'Mobile Developer', 'Python Developer', 'Java Developer',
                'React Developer', 'Node.js Developer', 'PHP Developer',
                'Data Analyst', 'Scrum Master', 'System Administrator',
                'Network Engineer', 'Cybersecurity Specialist', 'Database Administrator',
                'Cloud Architect', 'Software Architect', 'Technical Writer',
                'Game Developer', 'Blockchain Developer', 'AI Engineer',
                'ML Engineer', 'Web Designer', 'Graphic Designer',
                'Motion Designer', 'Brand Designer', 'Content Manager',
                'SMM Specialist', 'SEO Specialist', 'Performance –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥',
                'Digital –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥', 'Customer Success Manager', 'Account Manager',
                'HR Manager', 'Recruiter', 'Financial Analyst',
                'Business Intelligence Analyst', 'Operations Manager', 'Supply Chain Manager',
                'Logistics Coordinator', 'Quality Assurance Manager', 'Compliance Officer',
                'Risk Manager', 'Investment Banker', 'Financial Advisor',
                'Insurance Agent', 'Real Estate Agent', 'Property Manager',
                'Construction Manager', 'Architect', 'Civil Engineer',
                'Mechanical Engineer', 'Electrical Engineer', 'Chemical Engineer',
                'Biomedical Engineer', 'Aerospace Engineer', 'Environmental Engineer',
                'Industrial Designer', 'Interior Designer', 'Fashion Designer',
                'Photographer', 'Video Editor', 'Sound Engineer',
                'Music Producer', 'Artist', 'Musician', 'Actor',
                'Director', 'Producer', 'Screenwriter', 'Cinematographer',
                'Photo Editor', 'Illustrator', 'Art Director', 'Creative Director',
                'Package Designer', 'Environmental Designer', 'Landscape Architect',
                'Urban Planner', 'Teacher', 'Professor', 'Researcher',
                'Scientist', 'Doctor', 'Nurse', 'Pharmacist',
                'Veterinarian', 'Psychologist', 'Therapist', 'Social Worker',
                'Lawyer', 'Legal Assistant', 'Paralegal', 'Judge',
                'Journalist', 'Editor', 'Copywriter', 'Translator',
                'Interpreter', 'Librarian', 'Museum Curator', 'Archivist',
                'Chef', 'Barista', 'Waiter', 'Restaurant Manager',
                'Hotel Manager', 'Travel Agent', 'Tour Guide',
                'Event Coordinator', 'Wedding Planner', 'Personal Trainer',
                'Fitness Instructor', 'Yoga Instructor', 'Massage Therapist',
                'Beautician', 'Hair Stylist', 'Makeup Artist', 'Fashion Stylist'
            ];
            
            jobSearchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                
                if (query.length === 0) {
                    jobSearchResults.classList.add('hidden');
                    jobSearchClear.classList.add('hidden');
                    return;
                }
                
                jobSearchClear.classList.remove('hidden');
                
                const filtered = allProfessions.filter(profession => 
                    profession.toLowerCase().includes(query)
                ).slice(0, 10);
                
                if (filtered.length === 0) {
                    jobSearchResults.innerHTML = '<div class="no-results">–ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                } else {
                    jobSearchResults.innerHTML = filtered.map(profession => 
                        `<button class="job-search-result" onclick="selectProfession('${profession}')">${profession}</button>`
                    ).join('');
                }
                
                jobSearchResults.classList.remove('hidden');
            });
            
            if (jobSearchClear) {
                jobSearchClear.addEventListener('click', function() {
                    jobSearchInput.value = '';
                    jobSearchResults.classList.add('hidden');
                    jobSearchClear.classList.add('hidden');
                });
            }
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', function() {
            const testApiBtn = document.getElementById('testApiKey');
            if (testApiBtn) {
                testApiBtn.onclick = testOpenAIKey;
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–∏—Å–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π
            setupJobSearch();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            initializeApp();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initializeApp() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ü–≤–µ—Ç–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
            if (window.colorTokens) {
                // –¶–≤–µ—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º React Bits –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
            if (window.ReactBitsIntegration) {
                window.reactBits = new ReactBitsIntegration();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è RSS Aggregator
            if (typeof RSSAggregator !== 'undefined') {
                window.rssAggregator = new RSSAggregator();
                
                // –ü–æ–¥–∫–ª—é—á–∞–µ–º VK API –∫ RSS Aggregator
                if (window.vkApi) {
                    window.rssAggregator.vkApi = window.vkApi;
                    console.log('‚úÖ VK API –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ RSS Aggregator');
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                window.rssAggregator.setSelectedProfessions([1, 3]); // Frontend –∏ Fullstack Developer
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                window.rssAggregator.aggregateNews().then(articles => {
                    // –†–µ–Ω–¥–µ—Ä–∏–º —Å—Ç–∞—Ç—å–∏ –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–µ—Ä
                    if (window.newsRenderer) {
                        const feedContainer = document.getElementById('feedContainer');
                        if (feedContainer && articles.length > 0) {
                            window.newsRenderer.renderCards(articles, feedContainer);
                        }
                    }
                }).catch(error => {
                    // –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                });
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è NewsCardRenderer
            if (window.NewsCardRenderer) {
                window.newsRenderer = new NewsCardRenderer();
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –¥–æ–∫-–±–∞—Ä–∞
            setupDockNavigation();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
            setupSearchAndFilters();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º breadcrumb –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            setupBreadcrumbNavigation();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
            loadInitialContent();
        }
        
        // RSS Sources Management Functions
        function loadRssSources() {
            const sourcesList = document.getElementById('rssSourcesList');
            if (!sourcesList || !window.rssAggregator) return;
            
            const sources = window.rssAggregator.sources || [];
            
            if (sources.length === 0) {
                sourcesList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</p>';
                return;
            }
            
            sourcesList.innerHTML = sources.map(source => `
                <div class="source-card" data-source-id="${source.id}">
                    <div class="source-header">
                        <h4>${source.name}</h4>
                        <span class="source-badge ${source.category}">${getCategoryName(source.category)}</span>
                    </div>
                    <div class="source-url">${source.url}</div>
                    <div class="source-actions">
                        <button class="btn btn--ghost btn--sm toggle-source-btn" data-source-id="${source.id}">
                            ${source.enabled !== false ? '‚úì –ê–∫—Ç–∏–≤–µ–Ω' : '‚úó –û—Ç–∫–ª—é—á–µ–Ω'}
                        </button>
                        <button class="btn btn--ghost btn--sm delete-source-btn" data-source-id="${source.id}">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                </div>
            `).join('');
            
            // Attach event listeners
            sourcesList.querySelectorAll('.toggle-source-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sourceId = parseInt(this.dataset.sourceId);
                    toggleRssSource(sourceId);
                });
            });
            
            sourcesList.querySelectorAll('.delete-source-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sourceId = parseInt(this.dataset.sourceId);
                    deleteRssSource(sourceId);
                });
            });
        }
        
        function getCategoryName(category) {
            const names = {
                tech: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
                news: '–ù–æ–≤–æ—Å—Ç–∏',
                business: '–ë–∏–∑–Ω–µ—Å',
                design: '–î–∏–∑–∞–π–Ω',
                other: '–î—Ä—É–≥–æ–µ'
            };
            return names[category] || '–î—Ä—É–≥–æ–µ';
        }
        
        function toggleRssSource(sourceId) {
            if (!window.rssAggregator) return;
            
            const source = window.rssAggregator.sources.find(s => s.id === sourceId);
            if (source) {
                source.enabled = source.enabled === false ? true : false;
                if (typeof window.showToast === 'function') {
                    window.showToast(
                        `–ò—Å—Ç–æ—á–Ω–∏–∫ ${source.enabled ? '–≤–∫–ª—é—á–µ–Ω' : '–æ—Ç–∫–ª—é—á–µ–Ω'}`,
                        source.enabled ? 'success' : 'info'
                    );
                }
                loadRssSources();
            }
        }
        
        function deleteRssSource(sourceId) {
            if (!window.rssAggregator) return;
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫?')) {
                const index = window.rssAggregator.sources.findIndex(s => s.id === sourceId);
                if (index !== -1) {
                    const sourceName = window.rssAggregator.sources[index].name;
                    window.rssAggregator.sources.splice(index, 1);
                    if (typeof window.showToast === 'function') {
                        window.showToast(`–ò—Å—Ç–æ—á–Ω–∏–∫ "${sourceName}" —É–¥–∞–ª–µ–Ω`, 'success');
                    }
                    loadRssSources();
                }
            }
        }
        
        // Add new RSS source
        document.addEventListener('DOMContentLoaded', function() {
            const addBtn = document.getElementById('addRssSourceBtn');
            if (addBtn) {
                addBtn.addEventListener('click', function() {
                    const name = document.getElementById('rssSourceName').value.trim();
                    const url = document.getElementById('rssSourceUrl').value.trim();
                    const category = document.getElementById('rssSourceCategory').value;
                    
                    if (!name || !url) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                        }
                        return;
                    }
                    
                    if (!window.rssAggregator) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('RSS Aggregator –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
                        }
                        return;
                    }
                    
                    const newSource = {
                        id: Date.now(),
                        name: name,
                        url: url,
                        category: category,
                        enabled: true,
                        professions: []
                    };
                    
                    window.rssAggregator.sources.push(newSource);
                    
                    if (typeof window.showToast === 'function') {
                        window.showToast(`–ò—Å—Ç–æ—á–Ω–∏–∫ "${name}" –¥–æ–±–∞–≤–ª–µ–Ω`, 'success');
                    }
                    
                    // Clear inputs
                    document.getElementById('rssSourceName').value = '';
                    document.getElementById('rssSourceUrl').value = '';
                    
                    loadRssSources();
                });
            }
            
            // VK Groups Management
            setupVKGroupsManagement();
            
            // OpenAI API Management
            setupOpenAIManagement();
        });
        
        // VK Groups Management Functions
        function loadVKGroups() {
            const groupsList = document.getElementById('vkGroupsList');
            if (!groupsList) return;
            
            const vkGroups = JSON.parse(localStorage.getItem('custom_vk_groups') || '[]');
            const configGroups = window.CONFIG?.vkGroups || [];
            
            groupsList.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥—Ä—É–ø–ø—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
            configGroups.forEach(group => {
                const groupCard = document.createElement('div');
                groupCard.className = 'source-card';
                groupCard.innerHTML = `
                    <div class="source-info">
                        <div class="source-title">${group.name}</div>
                        <div class="source-url">vk.com/${group.id}</div>
                        <div class="source-category">${group.category}</div>
                    </div>
                    <div class="source-actions">
                        <span class="source-status ${group.enabled ? 'enabled' : 'disabled'}">
                            ${group.enabled ? '‚úÖ' : '‚ùå'}
                        </span>
                    </div>
                `;
                groupsList.appendChild(groupCard);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã
            vkGroups.forEach((group, index) => {
                const groupCard = document.createElement('div');
                groupCard.className = 'source-card custom-group';
                groupCard.innerHTML = `
                    <div class="source-info">
                        <div class="source-title">${group.name}</div>
                        <div class="source-url">vk.com/${group.id}</div>
                        <div class="source-category">${group.category}</div>
                    </div>
                    <div class="source-actions">
                        <button class="btn btn--ghost btn--sm" onclick="toggleVKGroup(${index})">
                            ${group.enabled ? '‚ùå –û—Ç–∫–ª—é—á–∏—Ç—å' : '‚úÖ –í–∫–ª—é—á–∏—Ç—å'}
                        </button>
                        <button class="btn btn--ghost btn--sm btn--danger" onclick="removeVKGroup(${index})">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                `;
                groupsList.appendChild(groupCard);
            });
        }
        
        function toggleVKGroup(index) {
            const vkGroups = JSON.parse(localStorage.getItem('custom_vk_groups') || '[]');
            if (vkGroups[index]) {
                vkGroups[index].enabled = !vkGroups[index].enabled;
                localStorage.setItem('custom_vk_groups', JSON.stringify(vkGroups));
                
                if (typeof window.showToast === 'function') {
                    window.showToast(
                        `–ì—Ä—É–ø–ø–∞ ${vkGroups[index].enabled ? '–≤–∫–ª—é—á–µ–Ω–∞' : '–æ—Ç–∫–ª—é—á–µ–Ω–∞'}`,
                        vkGroups[index].enabled ? 'success' : 'info'
                    );
                }
                loadVKGroups();
            }
        }
        
        function removeVKGroup(index) {
            const vkGroups = JSON.parse(localStorage.getItem('custom_vk_groups') || '[]');
            if (vkGroups[index]) {
                const groupName = vkGroups[index].name;
                vkGroups.splice(index, 1);
                localStorage.setItem('custom_vk_groups', JSON.stringify(vkGroups));
                
                if (typeof window.showToast === 'function') {
                    window.showToast(`–ì—Ä—É–ø–ø–∞ "${groupName}" —É–¥–∞–ª–µ–Ω–∞`, 'success');
                }
                loadVKGroups();
            }
        }
        
        function setupVKGroupsManagement() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º VK –≥—Ä—É–ø–ø—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
            const vkTab = document.querySelector('[data-tab="vk"]');
            if (vkTab) {
                vkTab.addEventListener('click', function() {
                    setTimeout(() => loadVKGroups(), 100);
                });
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è VK –≥—Ä—É–ø–ø—ã
            const addVkGroupBtn = document.getElementById('addVkGroupBtn');
            if (addVkGroupBtn) {
                addVkGroupBtn.addEventListener('click', function() {
                    const name = document.getElementById('vkGroupName').value.trim();
                    const id = document.getElementById('vkGroupId').value.trim();
                    const category = document.getElementById('vkGroupCategory').value;
                    
                    if (!name || !id) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ ID –≥—Ä—É–ø–ø—ã', 'error');
                        }
                        return;
                    }
                    
                    const vkGroups = JSON.parse(localStorage.getItem('custom_vk_groups') || '[]');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                    if (vkGroups.some(group => group.id === id)) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–ì—Ä—É–ø–ø–∞ —Å —Ç–∞–∫–∏–º ID —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'error');
                        }
                        return;
                    }
                    
                    const newGroup = {
                        id: id,
                        name: name,
                        category: category,
                        enabled: true,
                        url: `https://vk.com/${id}`,
                        relatedJobs: [] // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∑–∂–µ
                    };
                    
                    vkGroups.push(newGroup);
                    localStorage.setItem('custom_vk_groups', JSON.stringify(vkGroups));
                    
                    if (typeof window.showToast === 'function') {
                        window.showToast(`–ì—Ä—É–ø–ø–∞ "${name}" –¥–æ–±–∞–≤–ª–µ–Ω–∞`, 'success');
                    }
                    
                    // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
                    document.getElementById('vkGroupName').value = '';
                    document.getElementById('vkGroupId').value = '';
                    
                    loadVKGroups();
                });
            }
        }
        
        // OpenAI API Management Functions
        function loadApiKeyStatus() {
            const apiKey = localStorage.getItem('openai_api_key');
            const statusIcon = document.getElementById('apiStatusIcon');
            const statusTitle = document.getElementById('apiStatusTitle');
            const statusDesc = document.getElementById('apiStatusDesc');
            const statusCard = document.getElementById('apiStatusCard');
            const apiInput = document.getElementById('openaiApiKeyInput');
            
            if (apiKey) {
                statusIcon.textContent = '‚úÖ';
                statusTitle.textContent = 'API –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                statusDesc.textContent = `–ö–ª—é—á: ${apiKey.substring(0, 10)}...${apiKey.substring(apiKey.length - 4)}`;
                statusCard.style.borderColor = 'var(--success)';
                statusCard.style.background = 'rgba(79, 209, 199, 0.05)';
                apiInput.value = apiKey;
            } else {
                statusIcon.textContent = '‚ùå';
                statusTitle.textContent = 'API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                statusDesc.textContent = '–î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI —Ñ—É–Ω–∫—Ü–∏–π';
                statusCard.style.borderColor = 'var(--border-medium)';
                statusCard.style.background = 'var(--bg-secondary)';
                apiInput.value = '';
            }
        }
        
        function setupOpenAIManagement() {
            const saveBtn = document.getElementById('saveApiKeyBtn');
            const testBtn = document.getElementById('testApiKeyBtn');
            const removeBtn = document.getElementById('removeApiKeyBtn');
            const apiInput = document.getElementById('openaiApiKeyInput');
            
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    const apiKey = apiInput.value.trim();
                    
                    if (!apiKey) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á', 'error');
                        }
                        return;
                    }
                    
                    if (!apiKey.startsWith('sk-')) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞', 'error');
                        }
                        return;
                    }
                    
                    localStorage.setItem('openai_api_key', apiKey);
                    if (typeof window.showToast === 'function') {
                        window.showToast('OpenAI API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
                    }
                    loadApiKeyStatus();
                });
            }
            
            if (testBtn) {
                testBtn.addEventListener('click', async function() {
                    const apiKey = apiInput.value.trim() || localStorage.getItem('openai_api_key');
                    
                    if (!apiKey) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á', 'error');
                        }
                        return;
                    }
                    
                    testBtn.disabled = true;
                    testBtn.textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞...';
                    
                    try {
                        const response = await fetch('https://api.openai.com/v1/models', {
                            headers: {
                                'Authorization': `Bearer ${apiKey}`
                            }
                        });
                        
                        if (response.ok) {
                            if (typeof window.showToast === 'function') {
                                window.showToast('‚úÖ API –∫–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
                            }
                        } else {
                            if (typeof window.showToast === 'function') {
                                window.showToast('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á', 'error');
                            }
                        }
                    } catch (error) {
                        if (typeof window.showToast === 'function') {
                            window.showToast('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–∞', 'error');
                        }
                    } finally {
                        testBtn.disabled = false;
                        testBtn.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
                    }
                });
            }
            
            if (removeBtn) {
                removeBtn.addEventListener('click', function() {
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å API –∫–ª—é—á?')) {
                        localStorage.removeItem('openai_api_key');
                        if (typeof window.showToast === 'function') {
                            window.showToast('API –∫–ª—é—á —É–¥–∞–ª–µ–Ω', 'success');
                        }
                        loadApiKeyStatus();
                    }
                });
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ breadcrumb –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function setupBreadcrumbNavigation() {
            const breadcrumbItems = document.querySelectorAll('.breadcrumb-item');
            const pages = ['–õ–µ–Ω—Ç–∞', '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ', '–ü—Ä–æ—Ñ–∏–ª—å'];
            
            function updateBreadcrumb(activePageName) {
                breadcrumbItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.textContent.trim() === activePageName) {
                        item.classList.add('active');
                    }
                });
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ breadcrumb
            breadcrumbItems.forEach((item, index) => {
                item.addEventListener('click', () => {
                    const pageName = item.textContent.trim();
                    updateBreadcrumb(pageName);
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    if (pageName === '–õ–µ–Ω—Ç–∞') {
                        document.getElementById('feedPage').classList.add('active');
                    } else if (pageName === '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ') {
                        document.getElementById('favoritesPage').classList.add('active');
                        loadFavorites();
                    } else if (pageName === '–ü—Ä–æ—Ñ–∏–ª—å') {
                        document.getElementById('profilePage').classList.add('active');
                    }
                });
            });
            
            // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–õ–µ–Ω—Ç–∞"
            updateBreadcrumb('–õ–µ–Ω—Ç–∞');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            window.updateBreadcrumb = updateBreadcrumb;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π
        function loadFavorites() {
            const favoritesFeed = document.getElementById('favoritesFeed');
            const emptyFavorites = document.getElementById('emptyFavorites');
            const savedArticles = JSON.parse(localStorage.getItem('saved_articles') || '[]');
            
            if (savedArticles.length === 0) {
                favoritesFeed.innerHTML = '';
                emptyFavorites.classList.remove('hidden');
            } else {
                emptyFavorites.classList.add('hidden');
                
                if (window.newsRenderer) {
                    window.newsRenderer.renderCards(savedArticles, favoritesFeed);
                } else {
                    favoritesFeed.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
                }
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞
        function getCachedData(key, maxAge = 15 * 60 * 1000) {
            const cached = localStorage.getItem(key);
            if (!cached) return null;
            
            try {
                const data = JSON.parse(cached);
                const age = Date.now() - data.timestamp;
                
                if (age < maxAge) {
                    console.log(`‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à –¥–ª—è ${key} (–≤–æ–∑—Ä–∞—Å—Ç: ${Math.round(age/1000)}—Å)`);
                    return data.content;
                } else {
                    console.log(`‚ùå –ö–µ—à —É—Å—Ç–∞—Ä–µ–ª –¥–ª—è ${key}`);
                    localStorage.removeItem(key);
                    return null;
                }
            } catch (e) {
                return null;
            }
        }
        
        function setCachedData(key, content) {
            const data = {
                content: content,
                timestamp: Date.now()
            };
            localStorage.setItem(key, JSON.stringify(data));
            console.log(`üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω –∫–µ—à –¥–ª—è ${key}`);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        async function loadInitialContent(forceRefresh = false) {
            const feedContainer = document.getElementById('feedContainer');
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            if (!feedContainer || !window.rssAggregator || !window.newsRenderer) {
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à –µ—Å–ª–∏ –Ω–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            if (!forceRefresh) {
                const cachedArticles = getCachedData('news_cache');
                if (cachedArticles && cachedArticles.length > 0) {
                    window.newsRenderer.renderCards(cachedArticles, feedContainer);
                    window.cachedNewsHTML = feedContainer.innerHTML;
                    if (typeof window.showToast === 'function') {
                        window.showToast('üì∞ –ù–æ–≤–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∫–µ—à–∞', 'success');
                    }
                    return;
                }
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ RSS
            window.loadingState.setLoading('rss', true);
            
            try {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º skeleton loading
                feedContainer.innerHTML = window.newsRenderer.renderSkeleton(5);
                if (loadingSpinner) loadingSpinner.classList.remove('hidden');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏
                console.log('üì∞ –ó–∞–≥—Ä—É–∂–∞–µ–º RSS –Ω–æ–≤–æ—Å—Ç–∏...');
                let articles = await window.rssAggregator.aggregateNews(50);
                console.log('‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Å—Ç–∞—Ç–µ–π:', articles.length);
                
                // –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ —Ç–∏–ø—É –≤–∞–∫–∞–Ω—Å–∏–∏ –∏–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤
                const jobFilters = JSON.parse(localStorage.getItem('job_filters') || '{}');
                if (jobFilters.jobType && forceRefresh) {
                    // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
                    const jobTypeName = window.CONFIG?.jobTypes?.find(j => j.id === jobFilters.jobType)?.name;
                    if (jobTypeName) {
                        const searchTerms = jobTypeName.toLowerCase().split(' ');
                        articles = articles.filter(article => {
                            const content = (article.title + ' ' + article.description).toLowerCase();
                            return searchTerms.some(term => content.includes(term));
                        });
                    }
                }          
                if (articles && articles.length > 0) {
                    window.newsRenderer.renderCards(articles, feedContainer);
                    window.cachedNewsHTML = feedContainer.innerHTML;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à
                    setCachedData('news_cache', articles);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ fallback –¥–∞–Ω–Ω—ã–µ
                    const hasFallbackData = articles.some(article => article.isFallback);
                    if (hasFallbackData) {
                        showDemoDataNotification();
                    }
                } else {
                    feedContainer.innerHTML = window.newsRenderer.renderEmptyState();
                }
                
            } catch (error) {
                feedContainer.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">‚ö†Ô∏è</div>
                        <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
                        <button class="btn btn--primary" onclick="loadInitialContent(true)">
                            –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
                        </button>
                    </div>
                `;
            } finally {
                if (loadingSpinner) loadingSpinner.classList.add('hidden');
                window.loadingState.setLoading('rss', false);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
        function showDemoDataNotification() {
            const notification = document.createElement('div');
            notification.className = 'demo-notification';
            notification.innerHTML = `
                <div class="demo-notification-content">
                    <div class="demo-icon">üöÄ</div>
                    <div class="demo-text">
                        <h4>–î–µ–º–æ-—Ä–µ–∂–∏–º NewsHub</h4>
                        <p>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑-–∑–∞ CORS –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.</p>
                    </div>
                    <button class="demo-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 10000);
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–æ–∫-–±–∞—Ä–∞
        function setupDockNavigation() {
            const dockButtons = document.querySelectorAll('.dock-btn');
            const pages = document.querySelectorAll('.page');
            
            // –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º breadcrumb
            const pageToTitle = {
                'feedPage': '–õ–µ–Ω—Ç–∞',
                'favoritesPage': '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ', 
                'profilePage': '–ü—Ä–æ—Ñ–∏–ª—å'
            };
            
            dockButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetPage = this.getAttribute('data-page');
                    
                    if (targetPage) {
                        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                        pages.forEach(page => page.classList.remove('active'));
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–ª–µ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                        const targetPageElement = document.getElementById(targetPage);
                        if (targetPageElement) {
                            targetPageElement.classList.add('active');
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
                        dockButtons.forEach(btn => btn.classList.remove('active'));
                        this.classList.add('active');
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º breadcrumb
                        if (window.updateBreadcrumb && pageToTitle[targetPage]) {
                            window.updateBreadcrumb(pageToTitle[targetPage]);
                        }
                    }
                });
            });
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function setupSearchAndFilters() {
            // –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞
            const searchToggle = document.getElementById('searchToggle');
            const searchBar = document.getElementById('searchBar');
            
            if (searchToggle && searchBar) {
                searchToggle.addEventListener('click', function() {
                    searchBar.classList.toggle('hidden');
                    if (!searchBar.classList.contains('hidden')) {
                        const searchInput = document.getElementById('searchInput');
                        if (searchInput) {
                            searchInput.focus();
                        }
                    }
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –≤ –ø–æ–∏—Å–∫–µ
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.addEventListener('input', function(e) {
                        const query = e.target.value.trim();
                        if (query.length > 2) {
                            performSearch(query);
                        } else if (query.length === 0) {
                            clearSearchResults();
                        }
                    });
                    
                    searchInput.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            const query = e.target.value.trim();
                            if (query.length > 0) {
                                performSearch(query);
                            }
                        }
                        if (e.key === 'Escape') {
                            searchBar.classList.add('hidden');
                            e.target.value = '';
                            clearSearchResults();
                        }
                    });
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ (RSS –Ω–æ–≤–æ—Å—Ç–∏ + VK –ø–æ—Å—Ç—ã + –≤–∞–∫–∞–Ω—Å–∏–∏)
            async function performSearch(query) {
                const feedContainer = document.getElementById('feedContainer');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                feedContainer.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <div class="spinner"></div>
                        <h3>–ü–æ–∏—Å–∫ "${query}"...</h3>
                        <p>–ò—â–µ–º –≤ RSS –Ω–æ–≤–æ—Å—Ç—è—Ö, VK –ø–æ—Å—Ç–∞—Ö –∏ –≤–∞–∫–∞–Ω—Å–∏—è—Ö</p>
                    </div>
                `;
                
                let rssResults = [];
                let vkResults = [];
                let jobsResults = [];
                
                // –ü–æ–∏—Å–∫ –≤ RSS –Ω–æ–≤–æ—Å—Ç—è—Ö
                if (window.rssAggregator) {
                    rssResults = window.rssAggregator.searchArticles(query);
                }
                
                // –ü–æ–∏—Å–∫ –≤ VK –ø–æ—Å—Ç–∞—Ö (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞)
                if (window.rssAggregator) {
                    try {
                        const jobType = window.rssAggregator.detectJobTypeFromQuery(query);
                        if (jobType) {
                            console.log(`üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω —Ç–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞: ${jobType}`);
                            const vkPosts = await window.rssAggregator.loadVKPostsForJobType(jobType);
                            // –§–∏–ª—å—Ç—Ä—É–µ–º VK –ø–æ—Å—Ç—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É
                            vkResults = vkPosts.filter(post => 
                                post.title.toLowerCase().includes(query.toLowerCase()) ||
                                post.description.toLowerCase().includes(query.toLowerCase())
                            );
                        }
                    } catch (error) {
                        console.warn('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ VK:', error);
                    }
                }
                
                // –ü–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π –Ω–∞ HH.ru
                if (window.hhApi) {
                    try {
                        const hhResults = await window.hhApi.searchVacancies({
                            text: query,
                            per_page: 20
                        });
                        jobsResults = window.hhApi.transformVacancies(hhResults.items || []);
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π:', error);
                    }
                }
                
                const totalResults = rssResults.length + vkResults.length + jobsResults.length;
                
                if (totalResults > 0) {
                    displaySearchResults([...rssResults, ...vkResults], jobsResults, query);
                    console.log(`üîç –ù–∞–π–¥–µ–Ω–æ: ${rssResults.length} RSS, ${vkResults.length} VK, ${jobsResults.length} –≤–∞–∫–∞–Ω—Å–∏–π`);
                } else {
                    feedContainer.innerHTML = `
                        <div style="text-align: center; padding: 3rem;">
                            <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                            <p>–ü–æ –∑–∞–ø—Ä–æ—Å—É "${query}" –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>
                            <button class="btn btn--primary" onclick="clearSearchResults()">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ª–µ–Ω—Ç–µ</button>
                        </div>
                    `;
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ (–Ω–æ–≤–æ—Å—Ç–∏ + –≤–∞–∫–∞–Ω—Å–∏–∏)
            function displaySearchResults(newsResults, jobsResults, query) {
                const feedContainer = document.getElementById('feedContainer');
                if (!feedContainer) return;
                
                const totalResults = newsResults.length + jobsResults.length;
                
                let html = `
                    <div class="search-results-header">
                        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "${query}"</h3>
                        <p style="color: var(--text-secondary); margin: 0.5rem 0;">
                            –ù–∞–π–¥–µ–Ω–æ: ${newsResults.length} –Ω–æ–≤–æ—Å—Ç–µ–π, ${jobsResults.length} –≤–∞–∫–∞–Ω—Å–∏–π
                        </p>
                        <button class="btn btn--outline btn--sm" onclick="clearSearchResults()">
                            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ª–µ–Ω—Ç–µ
                        </button>
                    </div>
                `;
                
                feedContainer.innerHTML = html;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏
                if (newsResults.length > 0 && window.newsRenderer) {
                    const newsSection = document.createElement('div');
                    newsSection.innerHTML = '<h4 style="margin: 2rem 0 1rem 0; padding-left: 1rem;">üì∞ –ù–æ–≤–æ—Å—Ç–∏</h4>';
                    feedContainer.appendChild(newsSection);
                    window.newsRenderer.renderCards(newsResults.slice(0, 20), feedContainer);
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏
                if (jobsResults.length > 0) {
                    const jobsSection = document.createElement('div');
                    jobsSection.innerHTML = '<h4 style="margin: 2rem 0 1rem 0; padding-left: 1rem;">üíº –í–∞–∫–∞–Ω—Å–∏–∏</h4>';
                    feedContainer.appendChild(jobsSection);
                    
                    // –†–µ–Ω–¥–µ—Ä–∏–º –≤–∞–∫–∞–Ω—Å–∏–∏ —á–µ—Ä–µ–∑ displayJobs
                    const jobsContainer = document.createElement('div');
                    feedContainer.appendChild(jobsContainer);
                    
                    let jobsHTML = '<div class="jobs-grid">';
                    jobsResults.forEach(job => {
                        jobsHTML += `
                            <div class="job-card-compact" data-job-id="${job.id}" onclick="window.openJobDetails('${job.id}')">
                                ${job.companyLogo ? 
                                    `<img src="${job.companyLogo}" alt="${job.company}" class="job-logo">` 
                                    : '<div class="job-logo-placeholder">üíº</div>'}
                                <h4 class="job-title">${job.title}</h4>
                                <p class="job-company">${job.company}</p>
                                <div class="job-salary">${job.salary}</div>
                                <div class="job-location">üìç ${job.location}</div>
                                <div class="job-badge">${job.schedule === 'remote' ? 'üè† –£–¥–∞–ª–µ–Ω–∫–∞' : job.experience}</div>
                            </div>
                        `;
                    });
                    jobsHTML += '</div>';
                    jobsContainer.innerHTML = jobsHTML;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è –º–æ–¥–∞–ª–∫–∏
                    window.currentJobs = jobsResults;
                }
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
            function clearSearchResults() {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.value = '';
                }
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –ª–µ–Ω—Ç—É
                if (window.rssAggregator && window.newsRenderer) {
                    const feedContainer = document.getElementById('feedContainer');
                    if (feedContainer) {
                        feedContainer.innerHTML = '';
                        window.newsRenderer.renderCards(window.rssAggregator.articles, feedContainer);
                    }
                }
            }
            
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const settingsToggle = document.getElementById('settingsToggle');
            const settingsDropdown = document.getElementById('settingsDropdown');
            
            if (settingsToggle && settingsDropdown) {
                settingsToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º dropdown –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π
                    const rect = settingsToggle.getBoundingClientRect();
                    const isMobile = window.innerWidth <= 768;
                    
                    if (isMobile) {
                        // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö - fixed –ø–æ —Ü–µ–Ω—Ç—Ä—É
                        settingsDropdown.style.position = 'fixed';
                        settingsDropdown.style.top = '70px';
                        settingsDropdown.style.left = '1rem';
                        settingsDropdown.style.right = '1rem';
                    } else {
                        // –ù–∞ –¥–µ—Å–∫—Ç–æ–ø–µ - –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π
                        settingsDropdown.style.position = 'fixed';
                        settingsDropdown.style.top = (rect.bottom + 8) + 'px';
                        settingsDropdown.style.right = (window.innerWidth - rect.right) + 'px';
                        settingsDropdown.style.left = 'auto';
                    }
                    
                    settingsDropdown.classList.toggle('show');
                });
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
                document.addEventListener('click', function(e) {
                    if (!settingsDropdown.contains(e.target) && !settingsToggle.contains(e.target)) {
                        settingsDropdown.classList.remove('show');
                    }
                });
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                const manageSourcesBtn = document.getElementById('manageSourcesBtn');
                if (manageSourcesBtn) {
                    manageSourcesBtn.addEventListener('click', function() {
                        const rssModal = document.getElementById('rssSourcesModal');
                        if (rssModal) {
                            rssModal.classList.remove('hidden');
                            loadRssSources();
                        }
                        settingsDropdown.classList.remove('show');
                    });
                }
                
                const setupOpenAIBtn = document.getElementById('setupOpenAIBtn');
                if (setupOpenAIBtn) {
                    setupOpenAIBtn.addEventListener('click', function() {
                        const currentKey = localStorage.getItem('openai_api_key') || '';
                        const apiKey = prompt('–í–≤–µ–¥–∏—Ç–µ OpenAI API –∫–ª—é—á:\n(–ù–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è AI —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ—Ü–µ–Ω–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π)', currentKey);
                        
                        if (apiKey !== null && apiKey.trim()) {
                            localStorage.setItem('openai_api_key', apiKey.trim());
                            if (typeof window.showToast === 'function') {
                                window.showToast('‚úÖ OpenAI API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
                            }
                        } else if (apiKey !== null) {
                            localStorage.removeItem('openai_api_key');
                            if (typeof window.showToast === 'function') {
                                window.showToast('OpenAI API –∫–ª—é—á —É–¥–∞–ª–µ–Ω', 'info');
                            }
                        }
                        
                        settingsDropdown.classList.remove('show');
                    });
                }
                
                const updateFrequency = document.getElementById('updateFrequency');
                if (updateFrequency) {
                    updateFrequency.addEventListener('change', function() {
                        const frequency = this.value;
                        localStorage.setItem('update_frequency', frequency);
                        if (typeof window.showToast === 'function') {
                            window.showToast('–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞', 'success');
                        }
                    });
                }
            }
            
            // –ö–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ - –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —Ä–∞–∑
            function initializeFiltersButton() {
                const filtersToggle = document.getElementById('filtersToggle');
                const filtersModal = document.getElementById('filtersModal');
                
                if (filtersToggle && filtersModal) {
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                    filtersToggle.replaceWith(filtersToggle.cloneNode(true));
                    const newFiltersToggle = document.getElementById('filtersToggle');
                    
                    newFiltersToggle.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('üîß –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã');
                        filtersModal.classList.remove('hidden');
                    });
                }
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤
            initializeFiltersButton();
            
            // –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
            const editProfileBtn = document.getElementById('editProfileBtn');
            if (editProfileBtn) {
                editProfileBtn.addEventListener('click', function() {
                    window.openEditProfile();
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            const refreshBtn = document.getElementById('refreshBtn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', async function() {
                    console.log('üîÑ Refresh button clicked');
                    
                    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                    refreshBtn.disabled = true;
                    refreshBtn.style.opacity = '0.5';
                    
                    try {
                        const activeFilter = document.querySelector('.filter-chip.active')?.dataset.filter;
                        console.log('Active filter:', activeFilter);
                        
                        if (activeFilter === 'jobs') {
                            console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏...');
                            await window.loadJobsWithFilters(true);
                        } else if (activeFilter === 'all') {
                            console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç...');
                            await loadAllContent();
                        } else if (activeFilter === 'vk-news') {
                            console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º VK –ø–æ—Å—Ç—ã...');
                            const savedFilters = JSON.parse(localStorage.getItem('job_filters') || '{}');
                            if (savedFilters.jobType) {
                                await loadVKPostsForSelectedJobType(savedFilters.jobType);
                            }
                        } else {
                            console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º RSS –Ω–æ–≤–æ—Å—Ç–∏...');
                            await loadInitialContent(true);
                        }
                        
                        console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
                    } catch (error) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
                    } finally {
                        // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –æ–±—Ä–∞—Ç–Ω–æ
                        refreshBtn.disabled = false;
                        refreshBtn.style.opacity = '1';
                    }
                });
            }
            
            // –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
            const quickFilters = document.querySelectorAll('.filter-chip');
            quickFilters.forEach(chip => {
                chip.addEventListener('click', function() {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö
                    quickFilters.forEach(c => c.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–º—É
                    this.classList.add('active');
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
                    const filter = this.dataset.filter;
                    applyQuickFilter(filter);
                });
            });
            document.addEventListener('click', function(e) {
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                if (e.target.classList.contains('modal-backdrop') || e.target.classList.contains('modal-close')) {
                    const modal = e.target.closest('.modal');
                    if (modal) {
                        modal.classList.add('hidden');
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–∫-–±–∞—Ä –æ–±—Ä–∞—Ç–Ω–æ
                        document.body.classList.remove('modal-open');
                    }
                }
            });
            
            // –°–∫—Ä—ã—Ç–∏–µ –¥–æ–∫-–±–∞—Ä–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const modal = mutation.target;
                        if (modal.classList.contains('modal')) {
                            if (!modal.classList.contains('hidden')) {
                                // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ - —Å–∫—Ä—ã–≤–∞–µ–º –¥–æ–∫-–±–∞—Ä
                                document.body.classList.add('modal-open');
                            } else {
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                                const openModals = document.querySelectorAll('.modal:not(.hidden)');
                                if (openModals.length === 0) {
                                    // –í—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–∫-–±–∞—Ä
                                    document.body.classList.remove('modal-open');
                                }
                            }
                        }
                    }
                });
            });
            
            // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –≤—Å–µ–º–∏ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
            document.querySelectorAll('.modal').forEach(modal => {
                observer.observe(modal, { attributes: true, attributeFilter: ['class'] });
            });
            
            document.addEventListener('click', function(e) {
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "—á–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é"
                if (e.target.closest('.read-more-btn')) {
                    const btn = e.target.closest('.read-more-btn');
                    const articleId = btn.getAttribute('data-article-id');
                    if (articleId) {
                        openArticleModal(articleId);
                    }
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–æ–≤–æ—Å—Ç–∏ (—Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ newsCardRenderer)
                // –≠—Ç–æ—Ç –∫–æ–¥ –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
            });
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
        window.cachedNewsHTML = '';
        
        // –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏
        window.loadingState = {
            rss: false,
            vk: false,
            jobs: false,
            
            setLoading(type, isLoading) {
                this[type] = isLoading;
                this.updateUI();
            },
            
            isAnyLoading() {
                return this.rss || this.vk || this.jobs;
            },
            
            updateUI() {
                const feedContainer = document.getElementById('feedContainer');
                if (!feedContainer) return;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
                if (this.isAnyLoading()) {
                    const loadingTypes = [];
                    if (this.rss) loadingTypes.push('RSS –Ω–æ–≤–æ—Å—Ç–∏');
                    if (this.vk) loadingTypes.push('VK –ø–æ—Å—Ç—ã');
                    if (this.jobs) loadingTypes.push('–í–∞–∫–∞–Ω—Å–∏–∏');
                    
                    const loadingText = loadingTypes.join(' + ');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞
                    if (feedContainer.innerHTML.includes('spinner') || feedContainer.children.length === 0) {
                        feedContainer.innerHTML = `
                            <div style="text-align: center; padding: 3rem;">
                                <div class="spinner"></div>
                                <h3>–ó–∞–≥—Ä—É–∂–∞–µ–º ${loadingText}...</h3>
                                <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</p>
                            </div>
                        `;
                    }
                } else {
                    // –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å, –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                    feedContainer.innerHTML = '';
                }
            }
        };
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
        function applyQuickFilter(filter) {
            const feedContainer = document.getElementById('feedContainer');
            
            console.log('üîÑ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞:', filter);
            
            // –î–ª—è –≤–∞–∫–∞–Ω—Å–∏–π - –∑–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–µ–∑ API
            if (filter === 'jobs') {
                console.log('üíº –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π...', {
                    apiReady: window.apiReady,
                    loadJobsWithFilters: !!window.loadJobsWithFilters,
                    hhApi: !!window.hhApi
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤–∞–∫–∞–Ω—Å–∏–π
                if (!window.cachedNewsHTML) {
                    window.cachedNewsHTML = feedContainer.innerHTML;
                }
                
                // –ü—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º loadJobsWithFilters - –æ–Ω–∞ —Å–∞–º–∞ –ø–æ–¥–æ–∂–¥–µ—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if (typeof window.loadJobsWithFilters === 'function') {
                    console.log('‚úÖ loadJobsWithFilters –Ω–∞–π–¥–µ–Ω–∞, –≤—ã–∑—ã–≤–∞–µ–º');
                    window.loadJobsWithFilters(false);
                } else {
                    console.error('‚ùå loadJobsWithFilters –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                    feedContainer.innerHTML = `
                        <div style="text-align: center; padding: 3rem;">
                            <h3>‚ö†Ô∏è –û—à–∏–±–∫–∞</h3>
                            <p>–§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</p>
                            <button class="btn btn--primary" onclick="location.reload()">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
                        </div>
                    `;
                }
                return;
            }
            
            // –î–ª—è "–ù–æ–≤–æ—Å—Ç–∏" - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ RSS –Ω–æ–≤–æ—Å—Ç–∏
            if (filter === 'news') {
                if (window.cachedNewsHTML) {
                    feedContainer.innerHTML = window.cachedNewsHTML;
                }
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ RSS –Ω–æ–≤–æ—Å—Ç–∏ (–Ω–µ VK)
                const articles = feedContainer.querySelectorAll('.news-card');
                articles.forEach(article => {
                    const sourceType = article.dataset.sourceType;
                    if (sourceType !== 'vk' && !article.classList.contains('job-card')) {
                        article.style.display = 'block';
                        article.style.animation = 'fadeInUp 0.3s ease';
                    } else {
                        article.style.display = 'none';
                    }
                });
                return;
            }
            
            // –î–ª—è "–ù–æ–≤–æ—Å—Ç–∏ –∏–∑ –í–ö" - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ VK –ø–æ—Å—Ç—ã
            if (filter === 'vk-news') {
                if (window.cachedNewsHTML) {
                    feedContainer.innerHTML = window.cachedNewsHTML;
                }
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ VK –Ω–æ–≤–æ—Å—Ç–∏
                const articles = feedContainer.querySelectorAll('.news-card');
                let vkCount = 0;
                articles.forEach(article => {
                    const sourceType = article.dataset.sourceType;
                    if (sourceType === 'vk') {
                        article.style.display = 'block';
                        article.style.animation = 'fadeInUp 0.3s ease';
                        vkCount++;
                    } else {
                        article.style.display = 'none';
                    }
                });
                
                // –ï—Å–ª–∏ –Ω–µ—Ç VK –ø–æ—Å—Ç–æ–≤, –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏
                if (vkCount === 0) {
                    const savedFilters = JSON.parse(localStorage.getItem('job_filters') || '{}');
                    const jobType = savedFilters.jobType;
                    
                    if (jobType) {
                        console.log('üì± –ó–∞–≥—Ä—É–∂–∞–µ–º VK –ø–æ—Å—Ç—ã –¥–ª—è —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏:', jobType);
                        loadVKPostsForSelectedJobType(jobType);
                        
                        feedContainer.innerHTML = `
                            <div style="text-align: center; padding: 3rem;">
                                <div class="spinner"></div>
                                <h3>üì± –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –í–ö...</h3>
                                <p>–ò—â–µ–º –ø–æ—Å—Ç—ã –¥–ª—è —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏: <strong>${window.CONFIG?.jobTypes?.find(j => j.id === jobType)?.name || jobType}</strong></p>
                            </div>
                        `;
                    } else {
                        feedContainer.innerHTML = `
                            <div style="text-align: center; padding: 3rem;">
                                <h3>üì± –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏</h3>
                                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ VK –ø–æ—Å—Ç—ã</p>
                                <button class="btn btn--primary" onclick="document.getElementById('filtersToggle').click()">
                                    üîß –û—Ç–∫—Ä—ã—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                                </button>
                            </div>
                        `;
                    }
                }
                return;
            }
            
            // –î–ª—è "–í—Å–µ" - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º RSS, VK –∏ –≤–∞–∫–∞–Ω—Å–∏–∏ –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ
            if (filter === 'all') {
                loadAllContent();
                return;
            }
        }
        
        // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        async function loadAllContent() {
            const feedContainer = document.getElementById('feedContainer');
            const savedFilters = JSON.parse(localStorage.getItem('job_filters') || '{}');
            const jobType = savedFilters.jobType;
            
            let allContent = [];
            let hasRSS = false, hasVK = false, hasJobs = false;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å
            if (window.rssAggregator) hasRSS = true;
            if (jobType && window.rssAggregator) hasVK = true;
            if (window.hhApi) hasJobs = true;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
            window.loadingState.setLoading('rss', hasRSS);
            window.loadingState.setLoading('vk', hasVK);
            window.loadingState.setLoading('jobs', hasJobs);
            
            try {
                // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º RSS –Ω–æ–≤–æ—Å—Ç–∏
                if (hasRSS) {
                    console.log('üì∞ –ó–∞–≥—Ä—É–∂–∞–µ–º RSS –Ω–æ–≤–æ—Å—Ç–∏...');
                    const rssNews = await window.rssAggregator.aggregateNews();
                    allContent = [...allContent, ...rssNews];
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${rssNews.length} RSS –Ω–æ–≤–æ—Å—Ç–µ–π`);
                    window.loadingState.setLoading('rss', false);
                }
                
                // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º VK –ø–æ—Å—Ç—ã
                if (hasVK) {
                    console.log(`üì± –ó–∞–≥—Ä—É–∂–∞–µ–º VK –ø–æ—Å—Ç—ã –¥–ª—è —Ç–∏–ø–∞: ${jobType}`);
                    const vkPosts = await window.rssAggregator.loadVKPostsForJobType(jobType);
                    allContent = [...allContent, ...vkPosts];
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${vkPosts.length} VK –ø–æ—Å—Ç–æ–≤`);
                    window.loadingState.setLoading('vk', false);
                }
                
                // 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏
                if (hasJobs) {
                    console.log('üíº –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏...');
                    const jobsData = await window.hhApi.searchVacancies({
                        text: jobType ? window.CONFIG.jobTypes.find(j => j.id === jobType)?.name || '' : '',
                        area: savedFilters.city || '1',
                        per_page: 20
                    });
                    const jobs = window.hhApi.transformVacancies(jobsData.items || []);
                    allContent = [...allContent, ...jobs];
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${jobs.length} –≤–∞–∫–∞–Ω—Å–∏–π`);
                    window.loadingState.setLoading('jobs', false);
                }
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç
                if (allContent.length > 0) {
                    displayMixedContent(allContent);
                    console.log(`üéâ –í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${allContent.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤`);
                } else {
                    feedContainer.innerHTML = `
                        <div style="text-align: center; padding: 3rem;">
                            <h3>üòî –ù–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                            <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
                            <button class="btn btn--primary" onclick="loadAllContent()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', error);
                window.loadingState.setLoading('rss', false);
                window.loadingState.setLoading('vk', false);
                window.loadingState.setLoading('jobs', false);
                
                feedContainer.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <h3>‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑</p>
                        <button class="btn btn--primary" onclick="loadAllContent()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
                    </div>
                `;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function displayMixedContent(items) {
            const feedContainer = document.getElementById('feedContainer');
            if (!feedContainer || !items.length) return;
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
            const sortedItems = items.sort((a, b) => {
                const dateA = new Date(a.publishedAt || a.published_at || 0);
                const dateB = new Date(b.publishedAt || b.published_at || 0);
                return dateB - dateA;
            });
            
            const html = sortedItems.map(item => {
                if (item.type === 'job') {
                    return createJobCard(item);
                } else {
                    return createNewsCard(item);
                }
            }).join('');
            
            feedContainer.innerHTML = html;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            const cards = feedContainer.querySelectorAll('.news-card, .job-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.3s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 50);
            });
        }
        
        // –î–µ–º–æ-–≤–∞–∫–∞–Ω—Å–∏–∏ –∏ —Å—Ç–∞—Ä—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É–¥–∞–ª–µ–Ω—ã - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–π HH.ru API —Å —Å–µ—Ç–∫–æ–π
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å—Ç–∞—Ç—å–∏
        function openArticleModal(articleId) {
            const modal = document.getElementById('articleModal');
            const article = findArticleById(articleId);
            
            if (!article) {
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Ç–µ–∫—É—â–µ–π —Å—Ç–∞—Ç—å–∏
            modal.dataset.currentArticleId = articleId;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–∞–Ω–Ω—ã–º–∏
            document.getElementById('articleModalTitle').textContent = article.title;
            document.getElementById('articleModalIcon').textContent = getSourceIcon(article.source.category);
            document.getElementById('articleModalSource').textContent = article.source.name;
            document.getElementById('articleModalTime').textContent = formatTimeAgo(article.publishedAt);
            document.getElementById('articleModalContent').innerHTML = `
                <p>${article.description || '–ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç–∞—Ç—å–∏ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Å —Å–∞–π—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.'}</p>
                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${article.category}</p>
                <p><strong>–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è:</strong> ${article.readingTime} –º–∏–Ω</p>
            `;
            document.getElementById('articleModalLink').href = article.link;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
            const likeBtn = document.getElementById('articleModalLike');
            const saveBtn = document.getElementById('articleModalSave');
            
            likeBtn.querySelector('.like-count').textContent = article.likes || 0;
            likeBtn.onclick = () => toggleLike(articleId);
            saveBtn.onclick = () => toggleSave(articleId);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            loadComments(articleId);
            
            modal.classList.remove('hidden');
        }
        
        function closeArticleModal() {
            document.getElementById('articleModal').classList.add('hidden');
        }
        
        function findArticleById(articleId) {
            // –ò—â–µ–º —Å—Ç–∞—Ç—å—é –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            if (window.rssAggregator && window.rssAggregator.articles) {
                return window.rssAggregator.articles.find(article => article.id === articleId);
            }
            return null;
        }
        
        function toggleLike(articleId) {
            const article = findArticleById(articleId);
            if (!article) return;
            
            // –ü–æ–ª—É—á–∞–µ–º –ª–∞–π–∫–∏ –∏–∑ localStorage
            const likes = JSON.parse(localStorage.getItem('article_likes') || '{}');
            const isLiked = likes[articleId];
            
            if (isLiked) {
                delete likes[articleId];
                article.likes = Math.max(0, (article.likes || 0) - 1);
            } else {
                likes[articleId] = true;
                article.likes = (article.likes || 0) + 1;
            }
            
            localStorage.setItem('article_likes', JSON.stringify(likes));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateLikeButtons(articleId, article.likes, !isLiked);
        }
        
        function updateLikeButtons(articleId, likesCount, isLiked) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –ª–∞–π–∫ –¥–ª—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏
            const likeButtons = document.querySelectorAll(`[data-article-id="${articleId}"] .like-btn, #articleModalLike`);
            
            likeButtons.forEach(btn => {
                const countSpan = btn.querySelector('.like-count');
                if (countSpan) {
                    countSpan.textContent = likesCount;
                }
                
                if (isLiked) {
                    btn.classList.add('liked');
                } else {
                    btn.classList.remove('liked');
                }
            });
        }
        
        function toggleSave(articleId) {
            const article = findArticleById(articleId);
            if (!article) return;
            
            // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
            const savedArticles = JSON.parse(localStorage.getItem('saved_articles') || '[]');
            const index = savedArticles.findIndex(a => a.id === articleId);
            
            if (index > -1) {
                // –£–¥–∞–ª—è–µ–º –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                savedArticles.splice(index, 1);
                showToast('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                savedArticles.push(article);
                showToast('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', 'success');
            }
            
            localStorage.setItem('saved_articles', JSON.stringify(savedArticles));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI –∫–Ω–æ–ø–∫–∏
            updateSaveButton(articleId, index === -1);
        }
        
        function updateSaveButton(articleId, isSaved) {
            const saveBtn = document.getElementById('articleModalSave');
            if (saveBtn) {
                const svg = saveBtn.querySelector('svg');
                if (isSaved) {
                    svg.innerHTML = '<path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z" fill="currentColor"/>';
                    saveBtn.classList.add('active');
                } else {
                    svg.innerHTML = '<path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>';
                    saveBtn.classList.remove('active');
                }
            }
        }
        
        function loadComments(articleId) {
            const commentsList = document.getElementById('commentsList');
            const comments = JSON.parse(localStorage.getItem(`comments_${articleId}`) || '[]');
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
                return;
            }
            
            commentsList.innerHTML = comments.map(comment => `
                <div class="comment-item">
                    <div class="comment-author">${comment.author}</div>
                    <div class="comment-text">${comment.text}</div>
                    <div class="comment-time">${formatTimeAgo(new Date(comment.timestamp))}</div>
                </div>
            `).join('');
        }
        
        function addComment() {
            const commentText = document.getElementById('commentText');
            const text = commentText.value.trim();
            
            if (!text) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
                return;
            }
            
            const articleId = getCurrentArticleId();
            if (!articleId) return;
            
            const comments = JSON.parse(localStorage.getItem(`comments_${articleId}`) || '[]');
            const newComment = {
                id: Date.now(),
                author: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                text: text,
                timestamp: new Date().toISOString()
            };
            
            comments.unshift(newComment);
            localStorage.setItem(`comments_${articleId}`, JSON.stringify(comments));
            
            commentText.value = '';
            loadComments(articleId);
        }
        
        function getCurrentArticleId() {
            const modal = document.getElementById('articleModal');
            return modal.dataset.currentArticleId;
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getSourceIcon(category) {
            const icons = {
                'technology': 'üíª',
                'business': 'üí∞', 
                'general': 'üì∞',
                'science': 'üî¨',
                'health': 'üè•'
            };
            return icons[category] || 'üì∞';
        }
        
        function formatTimeAgo(date) {
            const now = new Date();
            const diff = now - new Date(date);
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (minutes < 60) return `${minutes} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            if (hours < 24) return `${hours} —á –Ω–∞–∑–∞–¥`;
            return `${days} –¥–Ω –Ω–∞–∑–∞–¥`;
        }
    </script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Service Worker
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
                                showUpdateNotification();
                            }
                        });
                    });
                } catch (error) {
                    // –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker
                }
            });
        }
        
        function showUpdateNotification() {
            const notification = document.createElement('div');
            notification.className = 'update-notification';
            notification.innerHTML = `
                <div class="update-content">
                    <span>üöÄ –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
                    <button onclick="updateApp()" class="btn btn--primary btn--sm">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button onclick="dismissUpdate()" class="btn btn--ghost btn--sm">–ü–æ–∑–∂–µ</button>
                </div>
            `;
            document.body.appendChild(notification);
        }
        
        function updateApp() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistration().then(registration => {
                    if (registration && registration.waiting) {
                        registration.waiting.postMessage({ type: 'SKIP_WAITING' });
                        window.location.reload();
                    }
                });
            }
        }
        
        function dismissUpdate() {
            const notification = document.querySelector('.update-notification');
            if (notification) {
                notification.remove();
            }
        }
    </script>

    <!-- API Integration Script -->
    <script type="module">
        import HHApiClient from './js/hhApi.js';
        import VKApiClient from './js/vkApi.js';
        import CONFIG from './js/config.js';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–æ–≤
        window.hhApi = new HHApiClient();
        window.vkApi = new VKApiClient();
        window.apiReady = true;
        window.CONFIG = CONFIG; // –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É –≥–ª–æ–±–∞–ª—å–Ω–æ

        console.log('‚úÖ HH.ru API initialized');
        console.log('‚úÖ VK API initialized');
        console.log('‚úÖ API Ready flag set');
        
        // VK —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ service token, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
        console.log('üì± VK API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç service token –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤');

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤–∞–∫–∞–Ω—Å–∏–π
        function setupJobFilters() {
            const applyBtn = document.getElementById('applyFiltersBtn');
            
            if (applyBtn) {
                applyBtn.addEventListener('click', async function() {
                    const jobType = document.getElementById('jobType')?.value || '';
                    const city = document.getElementById('jobCity')?.value || '1';
                    const experience = document.getElementById('jobExperience')?.value || '';
                    const schedule = document.getElementById('jobSchedule')?.value || '';
                    const employment = document.getElementById('jobEmployment')?.value || '';
                    const salary = document.getElementById('jobSalary')?.value || '';
                    const onlyWithSalary = document.getElementById('jobOnlyWithSalary')?.checked;

                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
                    localStorage.setItem('job_filters', JSON.stringify({
                        jobType,
                        city,
                        experience,
                        schedule,
                        employment,
                        salary,
                        onlyWithSalary
                    }));

                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
                    document.getElementById('filtersModal')?.classList.add('hidden');

                    // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤
                    initializeFiltersButton();

                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
                    const activeFilter = document.querySelector('.filter-chip.active')?.dataset.filter;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
                    if (activeFilter === 'jobs') {
                        // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã –≤–∞–∫–∞–Ω—Å–∏–∏ - –æ–±–Ω–æ–≤–ª—è–µ–º –∏—Ö —Å –Ω–æ–≤—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
                        console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏ —Å –Ω–æ–≤—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏');
                        loadJobsWithFilters(true);
                    } else if (activeFilter === 'vk-news') {
                        // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã VK –Ω–æ–≤–æ—Å—Ç–∏ - –æ–±–Ω–æ–≤–ª—è–µ–º –∏—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞
                        if (jobType) {
                            console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º VK –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è —Ç–∏–ø–∞:', jobType);
                            loadVKPostsForSelectedJobType(jobType);
                        }
                    } else if (activeFilter === 'all') {
                        // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ "–í—Å–µ" - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç
                        console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç —Å –Ω–æ–≤—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏');
                        loadAllContent();
                    }
                    
                    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ç–∏–ø –≤–∞–∫–∞–Ω—Å–∏–∏, –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ–º VK –ø–æ—Å—Ç—ã –≤ —Ñ–æ–Ω–µ
                    if (jobType) {
                        console.log('üì± –ó–∞–≥—Ä—É–∂–∞–µ–º VK –ø–æ—Å—Ç—ã –¥–ª—è —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏:', jobType);
                        loadVKPostsForSelectedJobType(jobType);
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    if (typeof window.showToast === 'function') {
                        window.showToast('–§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã! –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è...', 'success');
                    }
                });
            }
        }
        

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ VK –ø–æ—Å—Ç–æ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏
        window.loadVKPostsForSelectedJobType = async function loadVKPostsForSelectedJobType(jobType) {
            if (!window.rssAggregator || !jobType) return;
            
            console.log(`üì± –ó–∞–≥—Ä—É–∂–∞–µ–º VK –ø–æ—Å—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞: ${jobType}`);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ VK
            window.loadingState.setLoading('vk', true);
            
            try {
                const vkPosts = await window.rssAggregator.loadVKPostsForJobType(jobType);
                
                if (vkPosts.length > 0) {
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${vkPosts.length} VK –ø–æ—Å—Ç–æ–≤ –¥–ª—è ${jobType}`);
                    
                    // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ "VK –Ω–æ–≤–æ—Å—Ç–∏", –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
                    const activeFilter = document.querySelector('.filter-chip.active')?.dataset.filter;
                    if (activeFilter === 'vk-news') {
                        const feedContainer = document.getElementById('feedContainer');
                        const vkHTML = vkPosts.map(post => createNewsCard(post)).join('');
                        feedContainer.innerHTML = vkHTML;
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                        const cards = feedContainer.querySelectorAll('.news-card');
                        cards.forEach((card, index) => {
                            card.style.opacity = '0';
                            card.style.transform = 'translateY(20px)';
                            setTimeout(() => {
                                card.style.transition = 'all 0.3s ease';
                                card.style.opacity = '1';
                                card.style.transform = 'translateY(0)';
                            }, index * 50);
                        });
                    }
                    
                    // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ "–í—Å—ë", –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç
                    if (activeFilter === 'all') {
                        loadAllContent();
                    }
                } else {
                    console.log(`‚ÑπÔ∏è –ù–µ—Ç VK –ø–æ—Å—Ç–æ–≤ –¥–ª—è —Ç–∏–ø–∞ ${jobType}`);
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ VK –ø–æ—Å—Ç–æ–≤:', error);
            } finally {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ VK
                window.loadingState.setLoading('vk', false);
            }
        }
        
        // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
        window.loadJobsWithFilters = async function(forceRefresh = false) {
            console.log('üöÄ loadJobsWithFilters –≤—ã–∑–≤–∞–Ω–∞');
            window.jobsApiReady = true;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
            window.loadingState.setLoading('jobs', true);
            
            const filters = JSON.parse(localStorage.getItem('job_filters') || '{}');
            
            // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∫–µ—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            const cacheKey = `jobs_cache_${filters.jobType || 'all'}_${filters.city || '1'}`;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à –µ—Å–ª–∏ –Ω–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            if (!forceRefresh) {
                const cachedJobs = getCachedData(cacheKey);
                if (cachedJobs && cachedJobs.length > 0) {
                    displayJobs(cachedJobs);
                    showToast('üíº –í–∞–∫–∞–Ω—Å–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∫–µ—à–∞', 'success');
                    return;
                }
            }
            
            try {
                showLoadingSpinner();
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ–∏—Å–∫–∞ –∏–∑ —Ç–∏–ø–∞ –≤–∞–∫–∞–Ω—Å–∏–∏
                let searchText = '';
                if (filters.jobType) {
                    const jobTypeName = window.CONFIG?.jobTypes?.find(j => j.id === filters.jobType)?.name;
                    searchText = jobTypeName || filters.jobType;
                }
                
                const searchParams = {
                    text: searchText, // –ü–æ–∏—Å–∫ –ø–æ —Ç–∏–ø—É –≤–∞–∫–∞–Ω—Å–∏–∏
                    area: parseInt(filters.city) || 1,
                    per_page: 50  // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 50 –≤–∞–∫–∞–Ω—Å–∏–π
                };

                if (filters.experience) searchParams.experience = filters.experience;
                if (filters.schedule) searchParams.schedule = filters.schedule;
                if (filters.employment) searchParams.employment = filters.employment;

                const results = await window.hhApi.searchVacancies(searchParams);
                console.log('HH API —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', results);
                console.log('–ù–∞–π–¥–µ–Ω–æ –≤–∞–∫–∞–Ω—Å–∏–π:', results.items?.length || 0);
                
                let jobs = window.hhApi.transformVacancies(results.items || []);
                console.log('–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –≤–∞–∫–∞–Ω—Å–∏–π:', jobs.length);

                // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ
                if (filters.salary) {
                    const minSalary = parseInt(filters.salary);
                    jobs = jobs.filter(job => 
                        job.salaryFrom && job.salaryFrom >= minSalary
                    );
                }

                if (filters.onlyWithSalary) {
                    jobs = jobs.filter(job => job.salaryFrom || job.salaryTo);
                }

                console.log('–ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª–æ—Å—å –≤–∞–∫–∞–Ω—Å–∏–π:', jobs.length);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º
                setCachedData(cacheKey, jobs);
                
                displayJobs(jobs);
                hideLoadingSpinner();
                window.loadingState.setLoading('jobs', false);

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π:', error);
                showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π', 'error');
                hideLoadingSpinner();
                window.loadingState.setLoading('jobs', false);
            }
        };

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–π (3 –≤ —Ä—è–¥)
        function displayJobs(jobs) {
            console.log('üìã displayJobs –≤—ã–∑–≤–∞–Ω —Å', jobs.length, '–≤–∞–∫–∞–Ω—Å–∏—è–º–∏');
            
            const feedContainer = document.getElementById('feedContainer');
            if (!feedContainer) {
                console.error('‚ùå feedContainer –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }

            if (jobs.length === 0) {
                console.warn('‚ö†Ô∏è –ù–µ—Ç –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                feedContainer.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <h3>–í–∞–∫–∞–Ω—Å–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    </div>
                `;
                return;
            }

            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ 3 –≤–∞–∫–∞–Ω—Å–∏–∏
            let html = '<div class="jobs-grid">';
            
            jobs.forEach((job, index) => {
                html += `
                    <div class="job-card-compact" data-job-id="${job.id}" onclick="window.openJobDetails('${job.id}')">
                        ${job.companyLogo ? 
                            `<img src="${job.companyLogo}" alt="${job.company}" class="job-logo">` 
                            : '<div class="job-logo-placeholder">üíº</div>'}
                        <h4 class="job-title">${job.title}</h4>
                        <p class="job-company">${job.company}</p>
                        <div class="job-salary">${job.salary}</div>
                        <div class="job-location">üìç ${job.location}</div>
                        <div class="job-badge">${job.schedule === 'remote' ? 'üè† –£–¥–∞–ª–µ–Ω–∫–∞' : job.experience}</div>
                    </div>
                `;
            });
            
            html += '</div>';
            feedContainer.innerHTML = html;
            
            console.log('‚úÖ –í–∞–∫–∞–Ω—Å–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã. HTML –¥–ª–∏–Ω–∞:', html.length);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –º–æ–¥–∞–ª–∫–∏
            window.currentJobs = jobs;
        }

        function showLoadingSpinner() {
            const spinner = document.getElementById('loadingSpinner');
            if (spinner) spinner.classList.remove('hidden');
        }

        function hideLoadingSpinner() {
            const spinner = document.getElementById('loadingSpinner');
            if (spinner) spinner.classList.add('hidden');
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        window.showToast = function(message, type = 'info') {
            // –ï—Å–ª–∏ –µ—Å—Ç—å filterSystem, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            if (window.filterSystem && typeof window.filterSystem.showToast === 'function') {
                window.filterSystem.showToast(message, type);
                return;
            }
            
            // –ò–Ω–∞—á–µ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const toast = document.createElement('div');
            toast.className = `toast toast--${type}`;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                padding: 12px 20px;
                border-radius: 4px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        if (!document.getElementById('toast-styles')) {
            const style = document.createElement('style');
            style.id = 'toast-styles';
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', async function() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ CONFIG
            updateAppVersion();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ–ª–µ–∫—Ç—ã –∏–∑ CONFIG
            initializeJobFiltersFromConfig();
            
            setupJobFilters();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ UI
            const savedFilters = JSON.parse(localStorage.getItem('job_filters') || '{}');
            if (savedFilters.jobType) document.getElementById('jobType').value = savedFilters.jobType;
            if (savedFilters.city) document.getElementById('jobCity').value = savedFilters.city;
            if (savedFilters.experience) document.getElementById('jobExperience').value = savedFilters.experience;
            if (savedFilters.schedule) document.getElementById('jobSchedule').value = savedFilters.schedule;
            if (savedFilters.employment) document.getElementById('jobEmployment').value = savedFilters.employment;
            if (savedFilters.salary) document.getElementById('jobSalary').value = savedFilters.salary;
            if (savedFilters.onlyWithSalary) document.getElementById('jobOnlyWithSalary').checked = savedFilters.onlyWithSalary;

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            document.getElementById('clearAllDataBtn')?.addEventListener('click', clearAllData);
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            loadProfile();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
            initializeTabs();
            
            console.log('üöÄ NewsHub API Integration ready!');
        });
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function updateAppVersion() {
            const versionElement = document.getElementById('appVersion');
            if (versionElement && window.CONFIG?.app?.version) {
                versionElement.textContent = `v${window.CONFIG.app.version}`;
                versionElement.title = `NewsHub –≤–µ—Ä—Å–∏—è ${window.CONFIG.app.version}`;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ–ª–µ–∫—Ç–æ–≤ –∏–∑ CONFIG
        function initializeJobFiltersFromConfig() {
            if (!window.CONFIG) return;
            
            // –¢–∏–ø—ã –≤–∞–∫–∞–Ω—Å–∏–π —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const jobTypeSelect = document.getElementById('jobType');
            if (jobTypeSelect && window.CONFIG.jobTypes && window.CONFIG.jobCategories) {
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                const jobsByCategory = {};
                window.CONFIG.jobTypes.forEach(jobType => {
                    const category = jobType.category || 'other';
                    if (!jobsByCategory[category]) {
                        jobsByCategory[category] = [];
                    }
                    jobsByCategory[category].push(jobType);
                });
                
                // –°–æ–∑–¥–∞–µ–º optgroup –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                window.CONFIG.jobCategories.forEach(category => {
                    const jobs = jobsByCategory[category.id];
                    if (jobs && jobs.length > 0) {
                        const optgroup = document.createElement('optgroup');
                        optgroup.label = category.name;
                        
                        jobs.forEach(jobType => {
                            const option = document.createElement('option');
                            option.value = jobType.id;
                            option.textContent = jobType.name;
                            optgroup.appendChild(option);
                        });
                        
                        jobTypeSelect.appendChild(optgroup);
                    }
                });
            }
            
            // –ì–æ—Ä–æ–¥–∞
            const citySelect = document.getElementById('jobCity');
            if (citySelect && window.CONFIG.cities) {
                window.CONFIG.cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city.id;
                    option.textContent = city.name;
                    citySelect.appendChild(option);
                });
            }
            
            // –û–ø—ã—Ç
            const expSelect = document.getElementById('jobExperience');
            if (expSelect && window.CONFIG.experienceLevels) {
                window.CONFIG.experienceLevels.forEach(exp => {
                    const option = document.createElement('option');
                    option.value = exp.id;
                    option.textContent = exp.name;
                    expSelect.appendChild(option);
                });
            }
            
            // –ì—Ä–∞—Ñ–∏–∫
            const scheduleSelect = document.getElementById('jobSchedule');
            if (scheduleSelect && window.CONFIG.schedules) {
                window.CONFIG.schedules.forEach(schedule => {
                    const option = document.createElement('option');
                    option.value = schedule.id;
                    option.textContent = schedule.name;
                    scheduleSelect.appendChild(option);
                });
            }
            
            // –ó–∞–Ω—è—Ç–æ—Å—Ç—å
            const empSelect = document.getElementById('jobEmployment');
            if (empSelect && window.CONFIG.employmentTypes) {
                window.CONFIG.employmentTypes.forEach(emp => {
                    const option = document.createElement('option');
                    option.value = emp.id;
                    option.textContent = emp.name;
                    empSelect.appendChild(option);
                });
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∫–ª–∞–¥–æ–∫
        function initializeTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    // –£–±–∏—Ä–∞–µ–º active —É –≤—Å–µ—Ö
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º active –∫ —Ç–µ–∫—É—â–µ–º—É
                    this.classList.add('active');
                    document.getElementById(`${targetTab}-tab`)?.classList.add('active');
                });
            });
        }

        // ======= –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∞–∫–∞–Ω—Å–∏–π =======
        
        window.openJobDetails = function(jobId) {
            const job = window.currentJobs?.find(j => j.id === jobId);
            if (!job) return;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–æ–¥–∞–ª–∫—É
            document.getElementById('jobModalTitle').textContent = job.title;
            document.getElementById('jobModalCompany').textContent = job.company;
            document.getElementById('jobModalSalary').textContent = `üí∞ ${job.salary}`;
            document.getElementById('jobModalLocation').textContent = `üìç ${job.location}`;
            document.getElementById('jobModalExperience').textContent = `üìÖ ${job.experience}`;
            document.getElementById('jobModalSchedule').textContent = `‚è∞ ${job.schedule}`;
            document.getElementById('jobModalDescription').innerHTML = job.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
            document.getElementById('jobModalRequirements').innerHTML = job.requirements || '–ù–µ —É–∫–∞–∑–∞–Ω—ã';
            document.getElementById('jobModalResponsibility').innerHTML = job.responsibility || '–ù–µ —É–∫–∞–∑–∞–Ω—ã';
            document.getElementById('jobModalLink').href = job.url;
            
            // –õ–æ–≥–æ
            const logo = document.getElementById('jobModalLogo');
            if (job.companyLogo) {
                logo.src = job.companyLogo;
                logo.style.display = 'block';
            } else {
                logo.style.display = 'none';
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ—Ü–µ–Ω–∫—É
            document.getElementById('jobAIAssessment').style.display = 'none';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –≤–∞–∫–∞–Ω—Å–∏—é
            window.currentJob = job;
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
            document.getElementById('jobModal').classList.remove('hidden');
        };
        
        window.closeJobModal = function() {
            document.getElementById('jobModal').classList.add('hidden');
        };
        
        // ======= AI –§—É–Ω–∫—Ü–∏–∏ =======
        
        window.summarizeArticle = async function() {
            const btn = document.getElementById('summarizeArticleBtn');
            const originalText = btn.innerHTML;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ API –∫–ª—é—á–∞
            const apiKey = localStorage.getItem('openai_api_key');
            if (!apiKey) {
                if (typeof showToast === 'function') {
                    showToast('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ OpenAI API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö', 'error');
                }
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è...';
            btn.disabled = true;
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–∞—Ç—å–∏
                const content = document.getElementById('articleModalContent').textContent;
                const title = document.getElementById('articleModalTitle').textContent;
                
                // –í—ã–∑—ã–≤–∞–µ–º OpenAI API
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [{
                            role: 'system',
                            content: '–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∫—Ä–∞—Ç–∫–∏–µ —Å–∞–º–º–∞—Ä–∏ —Å—Ç–∞—Ç–µ–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–∏–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º, –±–µ–∑ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–π.'
                        }, {
                            role: 'user',
                            content: `–°–¥–µ–ª–∞–π –∫—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è):\n\n–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${title}\n\n–¢–µ–∫—Å—Ç: ${content.substring(0, 3000)}`
                        }],
                        max_tokens: 300,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || '–û—à–∏–±–∫–∞ API');
                }
                
                const data = await response.json();
                const summary = data.choices[0].message.content;
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'ai-summary';
                summaryDiv.innerHTML = `
                    <h4>üìù –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ (AI)</h4>
                    <p>${summary}</p>
                    <small style="color: var(--text-secondary); font-size: 0.75rem;">
                        –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é OpenAI GPT-3.5
                    </small>
                `;
                
                const modalBody = document.querySelector('.article-modal-body');
                const existingSummary = modalBody.querySelector('.ai-summary');
                if (existingSummary) {
                    existingSummary.remove();
                }
                modalBody.insertBefore(summaryDiv, modalBody.firstChild);
                
                if (typeof showToast === 'function') {
                    showToast('‚úÖ –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞!', 'success');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏:', error);
                if (typeof showToast === 'function') {
                    showToast(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                }
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        };
        
        window.assessJob = async function() {
            const btn = document.getElementById('assessJobBtn');
            const originalText = btn.innerHTML;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ API –∫–ª—é—á–∞
            const apiKey = localStorage.getItem('openai_api_key');
            if (!apiKey) {
                if (typeof showToast === 'function') {
                    showToast('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ OpenAI API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö', 'error');
                }
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> –û—Ü–µ–Ω–∫–∞...';
            btn.disabled = true;
            
            try {
                const job = window.currentJob;
                if (!job) return;
                
                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const userProfile = JSON.parse(localStorage.getItem('user_profile') || '{}');
                const userSkills = userProfile.skills || [];
                const userExperience = userProfile.experience || '–ù–µ —É–∫–∞–∑–∞–Ω';
                const userProfession = userProfile.profession || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                const userBio = userProfile.bio || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è OpenAI
                const prompt = `–û—Ü–µ–Ω–∏ –≤–∞–∫–∞–Ω—Å–∏—é –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é.

–í–ê–ö–ê–ù–°–ò–Ø:
–ü–æ–∑–∏—Ü–∏—è: ${job.title}
–ö–æ–º–ø–∞–Ω–∏—è: ${job.company}
–ó–∞—Ä–ø–ª–∞—Ç–∞: ${job.salary}
–õ–æ–∫–∞—Ü–∏—è: ${job.location}
–û–ø—ã—Ç: ${job.experience}
–ì—Ä–∞—Ñ–∏–∫: ${job.schedule}
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: ${job.requirements}
–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏: ${job.responsibility}

–ü–†–û–§–ò–õ–¨ –ö–ê–ù–î–ò–î–ê–¢–ê:
–ü—Ä–æ—Ñ–µ—Å—Å–∏—è: ${userProfession}
–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã: ${userExperience}
–ù–∞–≤—ã–∫–∏: ${userSkills.join(', ') || '–ù–µ —É–∫–∞–∑–∞–Ω—ã'}
–û —Å–µ–±–µ: ${userBio}

–ó–ê–î–ê–ß–ê:
1. –û—Ü–µ–Ω–∏ –≤–∞–∫–∞–Ω—Å–∏—é –ø–æ —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 100
2. –£–∫–∞–∂–∏ –ø–ª—é—Å—ã –≤–∞–∫–∞–Ω—Å–∏–∏ (—Å–ø–∏—Å–æ–∫)
3. –£–∫–∞–∂–∏ –º–∏–Ω—É—Å—ã –≤–∞–∫–∞–Ω—Å–∏–∏ (—Å–ø–∏—Å–æ–∫)
4. –£–∫–∞–∂–∏ —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç—É –¥–ª—è —ç—Ç–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏ (—Å–ø–∏—Å–æ–∫)
5. –î–∞–π –∫–æ—Ä–æ—Ç–∫—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é (–æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ)

–û—Ç–≤–µ—Ç –¥–∞–π –°–¢–†–û–ì–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
{
  "score": —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100,
  "recommendation": "—Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏",
  "pros": ["–ø—É–Ω–∫—Ç1", "–ø—É–Ω–∫—Ç2"],
  "cons": ["–ø—É–Ω–∫—Ç1", "–ø—É–Ω–∫—Ç2"],
  "missing": ["–ø—É–Ω–∫—Ç1", "–ø—É–Ω–∫—Ç2"]
}`;

                // –í—ã–∑—ã–≤–∞–µ–º OpenAI API
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [{
                            role: 'system',
                            content: '–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø–æ–¥–±–æ—Ä—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞. –û—Ü–µ–Ω–∏–≤–∞–µ—à—å –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤. –û—Ç–≤–µ—á–∞–µ—à—å —Ç–æ–ª—å–∫–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.'
                        }, {
                            role: 'user',
                            content: prompt
                        }],
                        max_tokens: 800,
                        temperature: 0.7,
                        response_format: { type: "json_object" }
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || '–û—à–∏–±–∫–∞ API');
                }
                
                const data = await response.json();
                const assessmentText = data.choices[0].message.content;
                const assessment = JSON.parse(assessmentText);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—Ü–µ–Ω–∫—É
                const assessmentDiv = document.getElementById('jobAIAssessment');
                const assessmentContent = document.getElementById('jobAIAssessmentContent');
                
                assessmentContent.innerHTML = `
                    <div class="ai-assessment-score">
                        <div class="score-badge">${assessment.score}/100</div>
                        <p class="recommendation">${assessment.recommendation}</p>
                    </div>
                    
                    ${assessment.pros && assessment.pros.length > 0 ? `
                        <div class="assessment-section pros">
                            <h5>‚úÖ –ü–ª—é—Å—ã:</h5>
                            <ul>${assessment.pros.map(p => `<li>${p}</li>`).join('')}</ul>
                        </div>
                    ` : ''}
                    
                    ${assessment.cons && assessment.cons.length > 0 ? `
                        <div class="assessment-section cons">
                            <h5>‚ùå –ú–∏–Ω—É—Å—ã:</h5>
                            <ul>${assessment.cons.map(c => `<li>${c}</li>`).join('')}</ul>
                        </div>
                    ` : ''}
                    
                    ${assessment.missing && assessment.missing.length > 0 ? `
                        <div class="assessment-section missing">
                            <h5>üìù –ß–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:</h5>
                            <ul>${assessment.missing.map(m => `<li>${m}</li>`).join('')}</ul>
                        </div>
                    ` : ''}
                    
                    <small style="color: var(--text-secondary); font-size: 0.75rem; display: block; margin-top: 1rem;">
                        –û—Ü–µ–Ω–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é OpenAI GPT-3.5 –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.
                    </small>
                `;
                
                assessmentDiv.style.display = 'block';
                
                if (typeof showToast === 'function') {
                    showToast('‚úÖ –û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–∞!', 'success');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ü–µ–Ω–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–∏:', error);
                if (typeof showToast === 'function') {
                    showToast(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                }
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        };
        
        // ======= –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è =======
        
        function loadProfile() {
            const profile = JSON.parse(localStorage.getItem('user_profile') || '{}');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ UI –ø—Ä–æ—Ñ–∏–ª—è
            if (profile.name) document.getElementById('profileName').textContent = profile.name;
            if (profile.profession) document.getElementById('profileProfession').textContent = profile.profession;
            if (profile.location) document.getElementById('profileLocation').textContent = profile.location;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞–≤—ã–∫–∏
            if (profile.skills && profile.skills.length > 0) {
                const skillsList = document.getElementById('skillsList');
                if (skillsList) {
                    skillsList.innerHTML = profile.skills.map(skill => 
                        `<span class="skill-tag">${skill}</span>`
                    ).join('');
                }
            }
        }
        
        window.openEditProfile = function() {
            const profile = JSON.parse(localStorage.getItem('user_profile') || '{}');
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            document.getElementById('profileNameInput').value = profile.name || '';
            document.getElementById('profileProfessionInput').value = profile.profession || '';
            document.getElementById('profileLocationInput').value = profile.location || '';
            document.getElementById('profileExperienceInput').value = profile.experience || '';
            document.getElementById('profileSkillsInput').value = profile.skills ? profile.skills.join(', ') : '';
            document.getElementById('profileBioInput').value = profile.bio || '';
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
            document.getElementById('editProfileModal').classList.remove('hidden');
        };
        
        window.closeEditProfileModal = function() {
            document.getElementById('editProfileModal').classList.add('hidden');
        };
        
        window.saveProfile = function() {
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
            const name = document.getElementById('profileNameInput').value.trim();
            const profession = document.getElementById('profileProfessionInput').value.trim();
            const location = document.getElementById('profileLocationInput').value.trim();
            const experience = document.getElementById('profileExperienceInput').value;
            const skillsText = document.getElementById('profileSkillsInput').value.trim();
            const bio = document.getElementById('profileBioInput').value.trim();
            
            // –ü–∞—Ä—Å–∏–º –Ω–∞–≤—ã–∫–∏
            const skills = skillsText 
                ? skillsText.split(',').map(s => s.trim()).filter(s => s.length > 0)
                : [];
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø—Ä–æ—Ñ–∏–ª—è
            const profile = {
                name: name || '–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
                profession: profession || '–ü—Ä–æ—Ñ–µ—Å—Å–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞',
                location: location || '–õ–æ–∫–∞—Ü–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞',
                experience: experience || '–ù–µ —É–∫–∞–∑–∞–Ω',
                skills: skills,
                bio: bio || '',
                updatedAt: new Date().toISOString()
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('user_profile', JSON.stringify(profile));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            loadProfile();
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
            closeEditProfileModal();
            
            if (typeof showToast === 'function') {
                showToast('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            }
            
            console.log('–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω:', profile);
        };
        
        // ======= –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö =======
        
        function clearAllData() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.')) {
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –≤—Å–µ localStorage
            const keysToKeep = ['theme']; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–º—É
            const allKeys = Object.keys(localStorage);
            
            allKeys.forEach(key => {
                if (!keysToKeep.includes(key)) {
                    localStorage.removeItem(key);
                }
            });
            
            // –û—á–∏—â–∞–µ–º API –∫—ç—à
            if (window.hhApi) window.hhApi.clearCache();
            if (window.vkApi) window.vkApi.cache?.clear();
            
            if (typeof showToast === 'function') {
                showToast('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!', 'success');
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            document.getElementById('settingsDropdown')?.classList.remove('active');
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }
    </script>
</body>
</html>